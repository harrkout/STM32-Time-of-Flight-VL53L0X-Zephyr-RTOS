<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.10.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Leshan-OMA-Lightweight-M2M-server-for-Zephyr: imgtool.main Namespace Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Leshan-OMA-Lightweight-M2M-server-for-Zephyr
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.10.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('namespaceimgtool_1_1main.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">imgtool.main Namespace Reference</div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classimgtool_1_1main_1_1AliasesGroup.html">AliasesGroup</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classimgtool_1_1main_1_1BasedIntParamType.html">BasedIntParamType</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a1cfa73a7c63d827c4ac5a161ae6b21c0" id="r_a1cfa73a7c63d827c4ac5a161ae6b21c0"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a1cfa73a7c63d827c4ac5a161ae6b21c0">gen_rsa2048</a> (keyfile, passwd)</td></tr>
<tr class="separator:a1cfa73a7c63d827c4ac5a161ae6b21c0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a562012d8320b41f6281688a0eead073c" id="r_a562012d8320b41f6281688a0eead073c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a562012d8320b41f6281688a0eead073c">gen_rsa3072</a> (keyfile, passwd)</td></tr>
<tr class="separator:a562012d8320b41f6281688a0eead073c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af50ef8f022c83934a2d5cd27209f9a2c" id="r_af50ef8f022c83934a2d5cd27209f9a2c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af50ef8f022c83934a2d5cd27209f9a2c">gen_ecdsa_p256</a> (keyfile, passwd)</td></tr>
<tr class="separator:af50ef8f022c83934a2d5cd27209f9a2c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a584190bf84a6801fc1bebdd152ffa5b9" id="r_a584190bf84a6801fc1bebdd152ffa5b9"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a584190bf84a6801fc1bebdd152ffa5b9">gen_ecdsa_p224</a> (keyfile, passwd)</td></tr>
<tr class="separator:a584190bf84a6801fc1bebdd152ffa5b9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a525003b0c619ec6eaf6e7bad25404d96" id="r_a525003b0c619ec6eaf6e7bad25404d96"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a525003b0c619ec6eaf6e7bad25404d96">gen_ed25519</a> (keyfile, passwd)</td></tr>
<tr class="separator:a525003b0c619ec6eaf6e7bad25404d96"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9617a94f2e12f0a824481676e301c1e7" id="r_a9617a94f2e12f0a824481676e301c1e7"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a9617a94f2e12f0a824481676e301c1e7">gen_x25519</a> (keyfile, passwd)</td></tr>
<tr class="separator:a9617a94f2e12f0a824481676e301c1e7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaaf41295d0bf65973fec484f4617fd1d" id="r_aaaf41295d0bf65973fec484f4617fd1d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aaaf41295d0bf65973fec484f4617fd1d">load_key</a> (keyfile)</td></tr>
<tr class="separator:aaaf41295d0bf65973fec484f4617fd1d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aded77192e5da28ea5fd228d2e5ace16a" id="r_aded77192e5da28ea5fd228d2e5ace16a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aded77192e5da28ea5fd228d2e5ace16a">get_password</a> ()</td></tr>
<tr class="separator:aded77192e5da28ea5fd228d2e5ace16a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1d47cb1f84149f3367af0f8c39faf703" id="r_a1d47cb1f84149f3367af0f8c39faf703"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a1d47cb1f84149f3367af0f8c39faf703">keygen</a> (type, key, password)</td></tr>
<tr class="separator:a1d47cb1f84149f3367af0f8c39faf703"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af1eaf2cb3a76603eb625c475014285e4" id="r_af1eaf2cb3a76603eb625c475014285e4"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af1eaf2cb3a76603eb625c475014285e4">getpub</a> (key, lang)</td></tr>
<tr class="separator:af1eaf2cb3a76603eb625c475014285e4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a87de27572cb0b2be5f7476a372446750" id="r_a87de27572cb0b2be5f7476a372446750"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a87de27572cb0b2be5f7476a372446750">getpriv</a> (key, minimal)</td></tr>
<tr class="separator:a87de27572cb0b2be5f7476a372446750"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9fb80e8878af709e9681bb57c4dc937c" id="r_a9fb80e8878af709e9681bb57c4dc937c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a9fb80e8878af709e9681bb57c4dc937c">verify</a> (key, imgfile)</td></tr>
<tr class="separator:a9fb80e8878af709e9681bb57c4dc937c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a367da607898cac63c40d2633b3023bc6" id="r_a367da607898cac63c40d2633b3023bc6"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a367da607898cac63c40d2633b3023bc6">validate_version</a> (ctx, param, value)</td></tr>
<tr class="separator:a367da607898cac63c40d2633b3023bc6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a015114210a41cb2b8c1489e3d317a299" id="r_a015114210a41cb2b8c1489e3d317a299"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a015114210a41cb2b8c1489e3d317a299">validate_security_counter</a> (ctx, param, value)</td></tr>
<tr class="separator:a015114210a41cb2b8c1489e3d317a299"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ade08829e20fbf743377138ca129cd962" id="r_ade08829e20fbf743377138ca129cd962"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ade08829e20fbf743377138ca129cd962">validate_header_size</a> (ctx, param, value)</td></tr>
<tr class="separator:ade08829e20fbf743377138ca129cd962"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aabff0709b3717acaf6a7393f9299b428" id="r_aabff0709b3717acaf6a7393f9299b428"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aabff0709b3717acaf6a7393f9299b428">get_dependencies</a> (ctx, param, value)</td></tr>
<tr class="separator:aabff0709b3717acaf6a7393f9299b428"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a185b883318f3188d9c36dd9c0f3d9a03" id="r_a185b883318f3188d9c36dd9c0f3d9a03"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a185b883318f3188d9c36dd9c0f3d9a03">sign</a> (key, public_key_format, align, <a class="el" href="#a6080dae0886626b9a4cedb29240708b1">version</a>, pad_sig, header_size, pad_header, slot_size, pad, confirm, max_sectors, overwrite_only, endian, encrypt_keylen, encrypt, infile, outfile, dependencies, load_addr, hex_addr, erased_val, save_enctlv, security_counter, boot_record, custom_tlv, rom_fixed, max_align, clear)</td></tr>
<tr class="separator:a185b883318f3188d9c36dd9c0f3d9a03"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6080dae0886626b9a4cedb29240708b1" id="r_a6080dae0886626b9a4cedb29240708b1"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a6080dae0886626b9a4cedb29240708b1">version</a> ()</td></tr>
<tr class="separator:a6080dae0886626b9a4cedb29240708b1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4358b33af1b779a3890a43b3944c19a4" id="r_a4358b33af1b779a3890a43b3944c19a4"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a4358b33af1b779a3890a43b3944c19a4">imgtool</a> ()</td></tr>
<tr class="separator:a4358b33af1b779a3890a43b3944c19a4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5d319663c2f7b0e4c27e42f3c7c15516" id="r_a5d319663c2f7b0e4c27e42f3c7c15516"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a5d319663c2f7b0e4c27e42f3c7c15516">sign</a> (key, public_key_format, align, <a class="el" href="#a6080dae0886626b9a4cedb29240708b1">version</a>, pad_sig, header_size, pad_header, slot_size, pad, confirm, max_sectors, overwrite_only, endian, encrypt, infile, outfile, dependencies, load_addr, hex_addr, erased_val, save_enctlv, security_counter, boot_record, custom_tlv, rom_fixed)</td></tr>
<tr class="separator:a5d319663c2f7b0e4c27e42f3c7c15516"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:aac9619ab98886780dde2f5acb6c247a5" id="r_aac9619ab98886780dde2f5acb6c247a5"><td class="memItemLeft" align="right" valign="top">tuple&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aac9619ab98886780dde2f5acb6c247a5">MIN_PYTHON_VERSION</a> = (3, 6)</td></tr>
<tr class="separator:aac9619ab98886780dde2f5acb6c247a5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1099a5c5707ff657c8d8cff4d271e982" id="r_a1099a5c5707ff657c8d8cff4d271e982"><td class="memItemLeft" align="right" valign="top">list&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a1099a5c5707ff657c8d8cff4d271e982">valid_langs</a> = ['c', 'rust']</td></tr>
<tr class="separator:a1099a5c5707ff657c8d8cff4d271e982"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a98d51dd5d8978724911620f66d76e2ec" id="r_a98d51dd5d8978724911620f66d76e2ec"><td class="memItemLeft" align="right" valign="top">dict&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a98d51dd5d8978724911620f66d76e2ec">keygens</a></td></tr>
<tr class="separator:a98d51dd5d8978724911620f66d76e2ec"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="a584190bf84a6801fc1bebdd152ffa5b9" name="a584190bf84a6801fc1bebdd152ffa5b9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a584190bf84a6801fc1bebdd152ffa5b9">&#9670;&#160;</a></span>gen_ecdsa_p224()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">gen_ecdsa_p224 </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>keyfile</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>passwd</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="imgtool_2main_8py_source.html#l00049">49</a> of file <a class="el" href="imgtool_2main_8py_source.html">main.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   49</span><span class="keyword">def </span>gen_ecdsa_p224(keyfile, passwd):</div>
<div class="line"><span class="lineno">   50</span>    print(<span class="stringliteral">&quot;TODO: p-224 not yet implemented&quot;</span>)</div>
<div class="line"><span class="lineno">   51</span> </div>
<div class="line"><span class="lineno">   52</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="af50ef8f022c83934a2d5cd27209f9a2c" name="af50ef8f022c83934a2d5cd27209f9a2c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af50ef8f022c83934a2d5cd27209f9a2c">&#9670;&#160;</a></span>gen_ecdsa_p256()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">gen_ecdsa_p256 </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>keyfile</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>passwd</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="imgtool_2main_8py_source.html#l00045">45</a> of file <a class="el" href="imgtool_2main_8py_source.html">main.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   45</span><span class="keyword">def </span>gen_ecdsa_p256(keyfile, passwd):</div>
<div class="line"><span class="lineno">   46</span>    keys.ECDSA256P1.generate().export_private(keyfile, passwd=passwd)</div>
<div class="line"><span class="lineno">   47</span> </div>
<div class="line"><span class="lineno">   48</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a525003b0c619ec6eaf6e7bad25404d96" name="a525003b0c619ec6eaf6e7bad25404d96"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a525003b0c619ec6eaf6e7bad25404d96">&#9670;&#160;</a></span>gen_ed25519()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">gen_ed25519 </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>keyfile</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>passwd</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="imgtool_2main_8py_source.html#l00053">53</a> of file <a class="el" href="imgtool_2main_8py_source.html">main.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   53</span><span class="keyword">def </span>gen_ed25519(keyfile, passwd):</div>
<div class="line"><span class="lineno">   54</span>    keys.Ed25519.generate().export_private(path=keyfile, passwd=passwd)</div>
<div class="line"><span class="lineno">   55</span> </div>
<div class="line"><span class="lineno">   56</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a1cfa73a7c63d827c4ac5a161ae6b21c0" name="a1cfa73a7c63d827c4ac5a161ae6b21c0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1cfa73a7c63d827c4ac5a161ae6b21c0">&#9670;&#160;</a></span>gen_rsa2048()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">gen_rsa2048 </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>keyfile</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>passwd</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="imgtool_2main_8py_source.html#l00036">36</a> of file <a class="el" href="imgtool_2main_8py_source.html">main.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   36</span><span class="keyword">def </span>gen_rsa2048(keyfile, passwd):</div>
<div class="line"><span class="lineno">   37</span>    keys.RSA.generate().export_private(path=keyfile, passwd=passwd)</div>
<div class="line"><span class="lineno">   38</span> </div>
<div class="line"><span class="lineno">   39</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a562012d8320b41f6281688a0eead073c" name="a562012d8320b41f6281688a0eead073c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a562012d8320b41f6281688a0eead073c">&#9670;&#160;</a></span>gen_rsa3072()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">gen_rsa3072 </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>keyfile</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>passwd</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="imgtool_2main_8py_source.html#l00040">40</a> of file <a class="el" href="imgtool_2main_8py_source.html">main.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   40</span><span class="keyword">def </span>gen_rsa3072(keyfile, passwd):</div>
<div class="line"><span class="lineno">   41</span>    keys.RSA.generate(key_size=3072).export_private(path=keyfile,</div>
<div class="line"><span class="lineno">   42</span>                                                    passwd=passwd)</div>
<div class="line"><span class="lineno">   43</span> </div>
<div class="line"><span class="lineno">   44</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a9617a94f2e12f0a824481676e301c1e7" name="a9617a94f2e12f0a824481676e301c1e7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9617a94f2e12f0a824481676e301c1e7">&#9670;&#160;</a></span>gen_x25519()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">gen_x25519 </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>keyfile</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>passwd</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="imgtool_2main_8py_source.html#l00057">57</a> of file <a class="el" href="imgtool_2main_8py_source.html">main.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   57</span><span class="keyword">def </span>gen_x25519(keyfile, passwd):</div>
<div class="line"><span class="lineno">   58</span>    keys.X25519.generate().export_private(path=keyfile, passwd=passwd)</div>
<div class="line"><span class="lineno">   59</span> </div>
<div class="line"><span class="lineno">   60</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="aabff0709b3717acaf6a7393f9299b428" name="aabff0709b3717acaf6a7393f9299b428"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aabff0709b3717acaf6a7393f9299b428">&#9670;&#160;</a></span>get_dependencies()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">get_dependencies </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>ctx</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>param</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>value</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="imgtool_2main_8py_source.html#l00194">194</a> of file <a class="el" href="imgtool_2main_8py_source.html">main.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  194</span><span class="keyword">def </span>get_dependencies(ctx, param, value):</div>
<div class="line"><span class="lineno">  195</span>    <span class="keywordflow">if</span> value <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  196</span>        versions = []</div>
<div class="line"><span class="lineno">  197</span>        images = re.findall(<span class="stringliteral">r&quot;\&zwj;((\d+)&quot;</span>, value)</div>
<div class="line"><span class="lineno">  198</span>        <span class="keywordflow">if</span> len(images) == 0:</div>
<div class="line"><span class="lineno">  199</span>            <span class="keywordflow">raise</span> click.BadParameter(</div>
<div class="line"><span class="lineno">  200</span>                <span class="stringliteral">&quot;Image dependency format is invalid: {}&quot;</span>.format(value))</div>
<div class="line"><span class="lineno">  201</span>        raw_versions = re.findall(<span class="stringliteral">r&quot;,\s*([0-9.+]+)\&zwj;)&quot;</span>, value)</div>
<div class="line"><span class="lineno">  202</span>        <span class="keywordflow">if</span> len(images) != len(raw_versions):</div>
<div class="line"><span class="lineno">  203</span>            <span class="keywordflow">raise</span> click.BadParameter(</div>
<div class="line"><span class="lineno">  204</span>                <span class="stringliteral">&#39;&#39;&#39;There&#39;s a mismatch between the number of dependency images</span></div>
<div class="line"><span class="lineno">  205</span><span class="stringliteral">                and versions in: {}&#39;&#39;&#39;</span>.format(value))</div>
<div class="line"><span class="lineno">  206</span>        <span class="keywordflow">for</span> raw_version <span class="keywordflow">in</span> raw_versions:</div>
<div class="line"><span class="lineno">  207</span>            <span class="keywordflow">try</span>:</div>
<div class="line"><span class="lineno">  208</span>                versions.append(decode_version(raw_version))</div>
<div class="line"><span class="lineno">  209</span>            <span class="keywordflow">except</span> ValueError <span class="keyword">as</span> e:</div>
<div class="line"><span class="lineno">  210</span>                <span class="keywordflow">raise</span> click.BadParameter(<span class="stringliteral">&quot;{}&quot;</span>.format(e))</div>
<div class="line"><span class="lineno">  211</span>        dependencies = dict()</div>
<div class="line"><span class="lineno">  212</span>        dependencies[image.DEP_IMAGES_KEY] = images</div>
<div class="line"><span class="lineno">  213</span>        dependencies[image.DEP_VERSIONS_KEY] = versions</div>
<div class="line"><span class="lineno">  214</span>        <span class="keywordflow">return</span> dependencies</div>
<div class="line"><span class="lineno">  215</span> </div>
<div class="line"><span class="lineno">  216</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="aded77192e5da28ea5fd228d2e5ace16a" name="aded77192e5da28ea5fd228d2e5ace16a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aded77192e5da28ea5fd228d2e5ace16a">&#9670;&#160;</a></span>get_password()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">get_password </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="imgtool_2main_8py_source.html#l00081">81</a> of file <a class="el" href="imgtool_2main_8py_source.html">main.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   81</span><span class="keyword">def </span>get_password():</div>
<div class="line"><span class="lineno">   82</span>    <span class="keywordflow">while</span> <span class="keyword">True</span>:</div>
<div class="line"><span class="lineno">   83</span>        passwd = getpass.getpass(<span class="stringliteral">&quot;Enter key passphrase: &quot;</span>)</div>
<div class="line"><span class="lineno">   84</span>        passwd2 = getpass.getpass(<span class="stringliteral">&quot;Reenter passphrase: &quot;</span>)</div>
<div class="line"><span class="lineno">   85</span>        <span class="keywordflow">if</span> passwd == passwd2:</div>
<div class="line"><span class="lineno">   86</span>            <span class="keywordflow">break</span></div>
<div class="line"><span class="lineno">   87</span>        print(<span class="stringliteral">&quot;Passwords do not match, try again&quot;</span>)</div>
<div class="line"><span class="lineno">   88</span> </div>
<div class="line"><span class="lineno">   89</span>    <span class="comment"># Password must be bytes, always use UTF-8 for consistent</span></div>
<div class="line"><span class="lineno">   90</span>    <span class="comment"># encoding.</span></div>
<div class="line"><span class="lineno">   91</span>    <span class="keywordflow">return</span> passwd.encode(<span class="stringliteral">&#39;utf-8&#39;</span>)</div>
<div class="line"><span class="lineno">   92</span> </div>
<div class="line"><span class="lineno">   93</span> </div>
<div class="line"><span class="lineno">   94</span><span class="preprocessor">@click.option</span>(<span class="stringliteral">&#39;-p&#39;</span>, <span class="stringliteral">&#39;--password&#39;</span>, is_flag=<span class="keyword">True</span>,</div>
<div class="line"><span class="lineno">   95</span>              help=<span class="stringliteral">&#39;Prompt for password to protect key&#39;</span>)</div>
<div class="line"><span class="lineno">   96</span><span class="preprocessor">@click.option</span>(<span class="stringliteral">&#39;-t&#39;</span>, <span class="stringliteral">&#39;--type&#39;</span>, metavar=<span class="stringliteral">&#39;type&#39;</span>, required=<span class="keyword">True</span>,</div>
<div class="line"><span class="lineno">   97</span>              type=click.Choice(keygens.keys()), prompt=<span class="keyword">True</span>,</div>
<div class="line"><span class="lineno">   98</span>              help=<span class="stringliteral">&#39;{}&#39;</span>.format(<span class="stringliteral">&#39;One of: {}&#39;</span>.format(<span class="stringliteral">&#39;, &#39;</span>.join(keygens.keys()))))</div>
<div class="line"><span class="lineno">   99</span><span class="preprocessor">@click.option(&#39;-k&#39;, &#39;--key&#39;, metavar=&#39;filename&#39;, required=True)</span></div>
<div class="line"><span class="lineno">  100</span><span class="preprocessor">@click.command(help=&#39;Generate pub/private keypair&#39;)</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a87de27572cb0b2be5f7476a372446750" name="a87de27572cb0b2be5f7476a372446750"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a87de27572cb0b2be5f7476a372446750">&#9670;&#160;</a></span>getpriv()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">getpriv </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>key</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>minimal</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="imgtool_2main_8py_source.html#l00129">129</a> of file <a class="el" href="imgtool_2main_8py_source.html">main.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  129</span><span class="keyword">def </span>getpriv(key, minimal):</div>
<div class="line"><span class="lineno">  130</span>    key = load_key(key)</div>
<div class="line"><span class="lineno">  131</span>    <span class="keywordflow">if</span> key <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  132</span>        print(<span class="stringliteral">&quot;Invalid passphrase&quot;</span>)</div>
<div class="line"><span class="lineno">  133</span>    <span class="keywordflow">try</span>:</div>
<div class="line"><span class="lineno">  134</span>        key.emit_private(minimal)</div>
<div class="line"><span class="lineno">  135</span>    <span class="keywordflow">except</span> (RSAUsageError, ECDSAUsageError, Ed25519UsageError,</div>
<div class="line"><span class="lineno">  136</span>            X25519UsageError) <span class="keyword">as</span> e:</div>
<div class="line"><span class="lineno">  137</span>        <span class="keywordflow">raise</span> click.UsageError(e)</div>
<div class="line"><span class="lineno">  138</span> </div>
<div class="line"><span class="lineno">  139</span> </div>
<div class="line"><span class="lineno">  140</span><span class="preprocessor">@click.argument(&#39;imgfile&#39;)</span></div>
<div class="line"><span class="lineno">  141</span><span class="preprocessor">@click.option(&#39;-k&#39;, &#39;--key&#39;, metavar=&#39;filename&#39;)</span></div>
<div class="line"><span class="lineno">  142</span><span class="preprocessor">@click.command(help=&quot;Check that signed image can be verified by given key&quot;)</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="af1eaf2cb3a76603eb625c475014285e4" name="af1eaf2cb3a76603eb625c475014285e4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af1eaf2cb3a76603eb625c475014285e4">&#9670;&#160;</a></span>getpub()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">getpub </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>key</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>lang</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="imgtool_2main_8py_source.html#l00110">110</a> of file <a class="el" href="imgtool_2main_8py_source.html">main.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  110</span><span class="keyword">def </span>getpub(key, lang):</div>
<div class="line"><span class="lineno">  111</span>    key = load_key(key)</div>
<div class="line"><span class="lineno">  112</span>    <span class="keywordflow">if</span> key <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  113</span>        print(<span class="stringliteral">&quot;Invalid passphrase&quot;</span>)</div>
<div class="line"><span class="lineno">  114</span>    <span class="keywordflow">elif</span> lang == <span class="stringliteral">&#39;c&#39;</span>:</div>
<div class="line"><span class="lineno">  115</span>        key.emit_c_public()</div>
<div class="line"><span class="lineno">  116</span>    <span class="keywordflow">elif</span> lang == <span class="stringliteral">&#39;rust&#39;</span>:</div>
<div class="line"><span class="lineno">  117</span>        key.emit_rust_public()</div>
<div class="line"><span class="lineno">  118</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  119</span>        <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;BUG: should never get here!&quot;</span>)</div>
<div class="line"><span class="lineno">  120</span> </div>
<div class="line"><span class="lineno">  121</span> </div>
<div class="line"><span class="lineno">  122</span><span class="preprocessor">@click.option</span>(<span class="stringliteral">&#39;--minimal&#39;</span>, default=<span class="keyword">False</span>, is_flag=<span class="keyword">True</span>,</div>
<div class="line"><span class="lineno">  123</span>              help=<span class="stringliteral">&#39;Reduce the size of the dumped private key to include only &#39;</span></div>
<div class="line"><span class="lineno">  124</span>                   <span class="stringliteral">&#39;the minimum amount of data required to decrypt. This &#39;</span></div>
<div class="line"><span class="lineno">  125</span>                   <span class="stringliteral">&#39;might require changes to the build config. Check the docs!&#39;</span></div>
<div class="line"><span class="lineno">  126</span>              )</div>
<div class="line"><span class="lineno">  127</span><span class="preprocessor">@click.option(&#39;-k&#39;, &#39;--key&#39;, metavar=&#39;filename&#39;, required=True)</span></div>
<div class="line"><span class="lineno">  128</span><span class="preprocessor">@click.command(help=&#39;Dump private key from keypair&#39;)</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a4358b33af1b779a3890a43b3944c19a4" name="a4358b33af1b779a3890a43b3944c19a4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4358b33af1b779a3890a43b3944c19a4">&#9670;&#160;</a></span>imgtool()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">imgtool </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="imgtool_2main_8py_source.html#l00391">391</a> of file <a class="el" href="imgtool_2main_8py_source.html">main.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  391</span><span class="keyword">def </span><a class="code hl_namespace" href="namespaceimgtool.html">imgtool</a>():</div>
<div class="line"><span class="lineno">  392</span>    <span class="keywordflow">pass</span></div>
<div class="line"><span class="lineno">  393</span> </div>
<div class="line"><span class="lineno">  394</span> </div>
<div class="ttc" id="anamespaceimgtool_html"><div class="ttname"><a href="namespaceimgtool.html">imgtool</a></div><div class="ttdef"><b>Definition</b> <a href="imgtool_2____init_____8py_source.html#l00001">__init__.py:1</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a1d47cb1f84149f3367af0f8c39faf703" name="a1d47cb1f84149f3367af0f8c39faf703"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1d47cb1f84149f3367af0f8c39faf703">&#9670;&#160;</a></span>keygen()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">keygen </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>type</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>key</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>password</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="imgtool_2main_8py_source.html#l00101">101</a> of file <a class="el" href="imgtool_2main_8py_source.html">main.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  101</span><span class="keyword">def </span>keygen(type, key, password):</div>
<div class="line"><span class="lineno">  102</span>    password = get_password() <span class="keywordflow">if</span> password <span class="keywordflow">else</span> <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno">  103</span>    keygens[type](key, password)</div>
<div class="line"><span class="lineno">  104</span> </div>
<div class="line"><span class="lineno">  105</span> </div>
<div class="line"><span class="lineno">  106</span><span class="preprocessor">@click.option</span>(<span class="stringliteral">&#39;-l&#39;</span>, <span class="stringliteral">&#39;--lang&#39;</span>, metavar=<span class="stringliteral">&#39;lang&#39;</span>, default=valid_langs[0],</div>
<div class="line"><span class="lineno">  107</span>              type=click.Choice(valid_langs))</div>
<div class="line"><span class="lineno">  108</span><span class="preprocessor">@click.option(&#39;-k&#39;, &#39;--key&#39;, metavar=&#39;filename&#39;, required=True)</span></div>
<div class="line"><span class="lineno">  109</span><span class="preprocessor">@click.command(help=&#39;Dump public key from keypair&#39;)</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="aaaf41295d0bf65973fec484f4617fd1d" name="aaaf41295d0bf65973fec484f4617fd1d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaaf41295d0bf65973fec484f4617fd1d">&#9670;&#160;</a></span>load_key()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">load_key </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>keyfile</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="imgtool_2main_8py_source.html#l00072">72</a> of file <a class="el" href="imgtool_2main_8py_source.html">main.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   72</span><span class="keyword">def </span>load_key(keyfile):</div>
<div class="line"><span class="lineno">   73</span>    <span class="comment"># TODO: better handling of invalid pass-phrase</span></div>
<div class="line"><span class="lineno">   74</span>    key = keys.load(keyfile)</div>
<div class="line"><span class="lineno">   75</span>    <span class="keywordflow">if</span> key <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">   76</span>        <span class="keywordflow">return</span> key</div>
<div class="line"><span class="lineno">   77</span>    passwd = getpass.getpass(<span class="stringliteral">&quot;Enter key passphrase: &quot;</span>).encode(<span class="stringliteral">&#39;utf-8&#39;</span>)</div>
<div class="line"><span class="lineno">   78</span>    <span class="keywordflow">return</span> keys.load(keyfile, passwd)</div>
<div class="line"><span class="lineno">   79</span> </div>
<div class="line"><span class="lineno">   80</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a5d319663c2f7b0e4c27e42f3c7c15516" name="a5d319663c2f7b0e4c27e42f3c7c15516"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5d319663c2f7b0e4c27e42f3c7c15516">&#9670;&#160;</a></span>sign() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sign </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>key</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>public_key_format</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>align</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>version</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>pad_sig</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>header_size</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>pad_header</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>slot_size</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>pad</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>confirm</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>max_sectors</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>overwrite_only</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>endian</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>encrypt</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>infile</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>outfile</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>dependencies</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>load_addr</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>hex_addr</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>erased_val</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>save_enctlv</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>security_counter</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>boot_record</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>custom_tlv</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>rom_fixed</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="imgtool__1_87_82_2imgtool_2main_8py_source.html#l00294">294</a> of file <a class="el" href="imgtool__1_87_82_2imgtool_2main_8py_source.html">main.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  298</span>         rom_fixed):</div>
<div class="line"><span class="lineno">  299</span> </div>
<div class="line"><span class="lineno">  300</span>    <span class="keywordflow">if</span> confirm:</div>
<div class="line"><span class="lineno">  301</span>        <span class="comment"># Confirmed but non-padded images don&#39;t make much sense, because</span></div>
<div class="line"><span class="lineno">  302</span>        <span class="comment"># otherwise there&#39;s no trailer area for writing the confirmed status.</span></div>
<div class="line"><span class="lineno">  303</span>        pad = <span class="keyword">True</span></div>
<div class="line"><span class="lineno">  304</span>    img = image.Image(version=decode_version(version), header_size=header_size,</div>
<div class="line"><span class="lineno">  305</span>                      pad_header=pad_header, pad=pad, confirm=confirm,</div>
<div class="line"><span class="lineno">  306</span>                      align=int(align), slot_size=slot_size,</div>
<div class="line"><span class="lineno">  307</span>                      max_sectors=max_sectors, overwrite_only=overwrite_only,</div>
<div class="line"><span class="lineno">  308</span>                      endian=endian, load_addr=load_addr, rom_fixed=rom_fixed,</div>
<div class="line"><span class="lineno">  309</span>                      erased_val=erased_val, save_enctlv=save_enctlv,</div>
<div class="line"><span class="lineno">  310</span>                      security_counter=security_counter)</div>
<div class="line"><span class="lineno">  311</span>    img.load(infile)</div>
<div class="line"><span class="lineno">  312</span>    key = load_key(key) <span class="keywordflow">if</span> key <span class="keywordflow">else</span> <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno">  313</span>    enckey = load_key(encrypt) <span class="keywordflow">if</span> encrypt <span class="keywordflow">else</span> <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno">  314</span>    <span class="keywordflow">if</span> enckey <span class="keywordflow">and</span> key:</div>
<div class="line"><span class="lineno">  315</span>        <span class="keywordflow">if</span> ((isinstance(key, keys.ECDSA256P1) <span class="keywordflow">and</span></div>
<div class="line"><span class="lineno">  316</span>             <span class="keywordflow">not</span> isinstance(enckey, keys.ECDSA256P1Public))</div>
<div class="line"><span class="lineno">  317</span>                <span class="keywordflow">or</span> (isinstance(key, keys.RSA) <span class="keywordflow">and</span></div>
<div class="line"><span class="lineno">  318</span>                    <span class="keywordflow">not</span> isinstance(enckey, keys.RSAPublic))):</div>
<div class="line"><span class="lineno">  319</span>            <span class="comment"># FIXME</span></div>
<div class="line"><span class="lineno">  320</span>            <span class="keywordflow">raise</span> click.UsageError(<span class="stringliteral">&quot;Signing and encryption must use the same &quot;</span></div>
<div class="line"><span class="lineno">  321</span>                                   <span class="stringliteral">&quot;type of key&quot;</span>)</div>
<div class="line"><span class="lineno">  322</span> </div>
<div class="line"><span class="lineno">  323</span>    <span class="keywordflow">if</span> pad_sig <span class="keywordflow">and</span> hasattr(key, <span class="stringliteral">&#39;pad_sig&#39;</span>):</div>
<div class="line"><span class="lineno">  324</span>        key.pad_sig = <span class="keyword">True</span></div>
<div class="line"><span class="lineno">  325</span> </div>
<div class="line"><span class="lineno">  326</span>    <span class="comment"># Get list of custom protected TLVs from the command-line</span></div>
<div class="line"><span class="lineno">  327</span>    custom_tlvs = {}</div>
<div class="line"><span class="lineno">  328</span>    <span class="keywordflow">for</span> tlv <span class="keywordflow">in</span> custom_tlv:</div>
<div class="line"><span class="lineno">  329</span>        tag = int(tlv[0], 0)</div>
<div class="line"><span class="lineno">  330</span>        <span class="keywordflow">if</span> tag <span class="keywordflow">in</span> custom_tlvs:</div>
<div class="line"><span class="lineno">  331</span>            <span class="keywordflow">raise</span> click.UsageError(<span class="stringliteral">&#39;Custom TLV %s already exists.&#39;</span> % hex(tag))</div>
<div class="line"><span class="lineno">  332</span>        <span class="keywordflow">if</span> tag <span class="keywordflow">in</span> image.TLV_VALUES.values():</div>
<div class="line"><span class="lineno">  333</span>            <span class="keywordflow">raise</span> click.UsageError(</div>
<div class="line"><span class="lineno">  334</span>                <span class="stringliteral">&#39;Custom TLV %s conflicts with predefined TLV.&#39;</span> % hex(tag))</div>
<div class="line"><span class="lineno">  335</span> </div>
<div class="line"><span class="lineno">  336</span>        value = tlv[1]</div>
<div class="line"><span class="lineno">  337</span>        <span class="keywordflow">if</span> value.startswith(<span class="stringliteral">&#39;0x&#39;</span>):</div>
<div class="line"><span class="lineno">  338</span>            <span class="keywordflow">if</span> len(value[2:]) % 2:</div>
<div class="line"><span class="lineno">  339</span>                <span class="keywordflow">raise</span> click.UsageError(<span class="stringliteral">&#39;Custom TLV length is odd.&#39;</span>)</div>
<div class="line"><span class="lineno">  340</span>            custom_tlvs[tag] = bytes.fromhex(value[2:])</div>
<div class="line"><span class="lineno">  341</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  342</span>            custom_tlvs[tag] = value.encode(<span class="stringliteral">&#39;utf-8&#39;</span>)</div>
<div class="line"><span class="lineno">  343</span> </div>
<div class="line"><span class="lineno">  344</span>    img.create(key, public_key_format, enckey, dependencies, boot_record,</div>
<div class="line"><span class="lineno">  345</span>               custom_tlvs)</div>
<div class="line"><span class="lineno">  346</span>    img.save(outfile, hex_addr)</div>
<div class="line"><span class="lineno">  347</span> </div>
<div class="line"><span class="lineno">  348</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a185b883318f3188d9c36dd9c0f3d9a03" name="a185b883318f3188d9c36dd9c0f3d9a03"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a185b883318f3188d9c36dd9c0f3d9a03">&#9670;&#160;</a></span>sign() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sign </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>key</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>public_key_format</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>align</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>version</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>pad_sig</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>header_size</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>pad_header</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>slot_size</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>pad</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>confirm</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>max_sectors</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>overwrite_only</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>endian</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>encrypt_keylen</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>encrypt</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>infile</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>outfile</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>dependencies</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>load_addr</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>hex_addr</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>erased_val</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>save_enctlv</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>security_counter</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>boot_record</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>custom_tlv</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>rom_fixed</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>max_align</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>clear</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="imgtool_2main_8py_source.html#l00309">309</a> of file <a class="el" href="imgtool_2main_8py_source.html">main.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  313</span>         boot_record, custom_tlv, rom_fixed, max_align, clear):</div>
<div class="line"><span class="lineno">  314</span> </div>
<div class="line"><span class="lineno">  315</span>    <span class="keywordflow">if</span> confirm:</div>
<div class="line"><span class="lineno">  316</span>        <span class="comment"># Confirmed but non-padded images don&#39;t make much sense, because</span></div>
<div class="line"><span class="lineno">  317</span>        <span class="comment"># otherwise there&#39;s no trailer area for writing the confirmed status.</span></div>
<div class="line"><span class="lineno">  318</span>        pad = <span class="keyword">True</span></div>
<div class="line"><span class="lineno">  319</span>    img = image.Image(version=decode_version(version), header_size=header_size,</div>
<div class="line"><span class="lineno">  320</span>                      pad_header=pad_header, pad=pad, confirm=confirm,</div>
<div class="line"><span class="lineno">  321</span>                      align=int(align), slot_size=slot_size,</div>
<div class="line"><span class="lineno">  322</span>                      max_sectors=max_sectors, overwrite_only=overwrite_only,</div>
<div class="line"><span class="lineno">  323</span>                      endian=endian, load_addr=load_addr, rom_fixed=rom_fixed,</div>
<div class="line"><span class="lineno">  324</span>                      erased_val=erased_val, save_enctlv=save_enctlv,</div>
<div class="line"><span class="lineno">  325</span>                      security_counter=security_counter, max_align=max_align)</div>
<div class="line"><span class="lineno">  326</span>    img.load(infile)</div>
<div class="line"><span class="lineno">  327</span>    key = load_key(key) <span class="keywordflow">if</span> key <span class="keywordflow">else</span> <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno">  328</span>    enckey = load_key(encrypt) <span class="keywordflow">if</span> encrypt <span class="keywordflow">else</span> <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno">  329</span>    <span class="keywordflow">if</span> enckey <span class="keywordflow">and</span> key:</div>
<div class="line"><span class="lineno">  330</span>        <span class="keywordflow">if</span> ((isinstance(key, keys.ECDSA256P1) <span class="keywordflow">and</span></div>
<div class="line"><span class="lineno">  331</span>             <span class="keywordflow">not</span> isinstance(enckey, keys.ECDSA256P1Public))</div>
<div class="line"><span class="lineno">  332</span>                <span class="keywordflow">or</span> (isinstance(key, keys.RSA) <span class="keywordflow">and</span></div>
<div class="line"><span class="lineno">  333</span>                    <span class="keywordflow">not</span> isinstance(enckey, keys.RSAPublic))):</div>
<div class="line"><span class="lineno">  334</span>            <span class="comment"># FIXME</span></div>
<div class="line"><span class="lineno">  335</span>            <span class="keywordflow">raise</span> click.UsageError(<span class="stringliteral">&quot;Signing and encryption must use the same &quot;</span></div>
<div class="line"><span class="lineno">  336</span>                                   <span class="stringliteral">&quot;type of key&quot;</span>)</div>
<div class="line"><span class="lineno">  337</span> </div>
<div class="line"><span class="lineno">  338</span>    <span class="keywordflow">if</span> pad_sig <span class="keywordflow">and</span> hasattr(key, <span class="stringliteral">&#39;pad_sig&#39;</span>):</div>
<div class="line"><span class="lineno">  339</span>        key.pad_sig = <span class="keyword">True</span></div>
<div class="line"><span class="lineno">  340</span> </div>
<div class="line"><span class="lineno">  341</span>    <span class="comment"># Get list of custom protected TLVs from the command-line</span></div>
<div class="line"><span class="lineno">  342</span>    custom_tlvs = {}</div>
<div class="line"><span class="lineno">  343</span>    <span class="keywordflow">for</span> tlv <span class="keywordflow">in</span> custom_tlv:</div>
<div class="line"><span class="lineno">  344</span>        tag = int(tlv[0], 0)</div>
<div class="line"><span class="lineno">  345</span>        <span class="keywordflow">if</span> tag <span class="keywordflow">in</span> custom_tlvs:</div>
<div class="line"><span class="lineno">  346</span>            <span class="keywordflow">raise</span> click.UsageError(<span class="stringliteral">&#39;Custom TLV %s already exists.&#39;</span> % hex(tag))</div>
<div class="line"><span class="lineno">  347</span>        <span class="keywordflow">if</span> tag <span class="keywordflow">in</span> image.TLV_VALUES.values():</div>
<div class="line"><span class="lineno">  348</span>            <span class="keywordflow">raise</span> click.UsageError(</div>
<div class="line"><span class="lineno">  349</span>                <span class="stringliteral">&#39;Custom TLV %s conflicts with predefined TLV.&#39;</span> % hex(tag))</div>
<div class="line"><span class="lineno">  350</span> </div>
<div class="line"><span class="lineno">  351</span>        value = tlv[1]</div>
<div class="line"><span class="lineno">  352</span>        <span class="keywordflow">if</span> value.startswith(<span class="stringliteral">&#39;0x&#39;</span>):</div>
<div class="line"><span class="lineno">  353</span>            <span class="keywordflow">if</span> len(value[2:]) % 2:</div>
<div class="line"><span class="lineno">  354</span>                <span class="keywordflow">raise</span> click.UsageError(<span class="stringliteral">&#39;Custom TLV length is odd.&#39;</span>)</div>
<div class="line"><span class="lineno">  355</span>            custom_tlvs[tag] = bytes.fromhex(value[2:])</div>
<div class="line"><span class="lineno">  356</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  357</span>            custom_tlvs[tag] = value.encode(<span class="stringliteral">&#39;utf-8&#39;</span>)</div>
<div class="line"><span class="lineno">  358</span> </div>
<div class="line"><span class="lineno">  359</span>    img.create(key, public_key_format, enckey, dependencies, boot_record,</div>
<div class="line"><span class="lineno">  360</span>               custom_tlvs, int(encrypt_keylen), clear)</div>
<div class="line"><span class="lineno">  361</span>    img.save(outfile, hex_addr)</div>
<div class="line"><span class="lineno">  362</span> </div>
<div class="line"><span class="lineno">  363</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ade08829e20fbf743377138ca129cd962" name="ade08829e20fbf743377138ca129cd962"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ade08829e20fbf743377138ca129cd962">&#9670;&#160;</a></span>validate_header_size()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">validate_header_size </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>ctx</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>param</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>value</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="imgtool_2main_8py_source.html#l00186">186</a> of file <a class="el" href="imgtool_2main_8py_source.html">main.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  186</span><span class="keyword">def </span>validate_header_size(ctx, param, value):</div>
<div class="line"><span class="lineno">  187</span>    min_hdr_size = image.IMAGE_HEADER_SIZE</div>
<div class="line"><span class="lineno">  188</span>    <span class="keywordflow">if</span> value &lt; min_hdr_size:</div>
<div class="line"><span class="lineno">  189</span>        <span class="keywordflow">raise</span> click.BadParameter(</div>
<div class="line"><span class="lineno">  190</span>            <span class="stringliteral">&quot;Minimum value for -H/--header-size is {}&quot;</span>.format(min_hdr_size))</div>
<div class="line"><span class="lineno">  191</span>    <span class="keywordflow">return</span> value</div>
<div class="line"><span class="lineno">  192</span> </div>
<div class="line"><span class="lineno">  193</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a015114210a41cb2b8c1489e3d317a299" name="a015114210a41cb2b8c1489e3d317a299"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a015114210a41cb2b8c1489e3d317a299">&#9670;&#160;</a></span>validate_security_counter()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">validate_security_counter </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>ctx</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>param</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>value</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="imgtool_2main_8py_source.html#l00172">172</a> of file <a class="el" href="imgtool_2main_8py_source.html">main.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  172</span><span class="keyword">def </span>validate_security_counter(ctx, param, value):</div>
<div class="line"><span class="lineno">  173</span>    <span class="keywordflow">if</span> value <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  174</span>        <span class="keywordflow">if</span> value.lower() == <span class="stringliteral">&#39;auto&#39;</span>:</div>
<div class="line"><span class="lineno">  175</span>            <span class="keywordflow">return</span> <span class="stringliteral">&#39;auto&#39;</span></div>
<div class="line"><span class="lineno">  176</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  177</span>            <span class="keywordflow">try</span>:</div>
<div class="line"><span class="lineno">  178</span>                <span class="keywordflow">return</span> int(value, 0)</div>
<div class="line"><span class="lineno">  179</span>            <span class="keywordflow">except</span> ValueError:</div>
<div class="line"><span class="lineno">  180</span>                <span class="keywordflow">raise</span> click.BadParameter(</div>
<div class="line"><span class="lineno">  181</span>                    <span class="stringliteral">&quot;{} is not a valid integer. Please use code literals &quot;</span></div>
<div class="line"><span class="lineno">  182</span>                    <span class="stringliteral">&quot;prefixed with 0b/0B, 0o/0O, or 0x/0X as necessary.&quot;</span></div>
<div class="line"><span class="lineno">  183</span>                    .format(value))</div>
<div class="line"><span class="lineno">  184</span> </div>
<div class="line"><span class="lineno">  185</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a367da607898cac63c40d2633b3023bc6" name="a367da607898cac63c40d2633b3023bc6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a367da607898cac63c40d2633b3023bc6">&#9670;&#160;</a></span>validate_version()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">validate_version </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>ctx</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>param</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>value</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="imgtool_2main_8py_source.html#l00164">164</a> of file <a class="el" href="imgtool_2main_8py_source.html">main.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  164</span><span class="keyword">def </span>validate_version(ctx, param, value):</div>
<div class="line"><span class="lineno">  165</span>    <span class="keywordflow">try</span>:</div>
<div class="line"><span class="lineno">  166</span>        decode_version(value)</div>
<div class="line"><span class="lineno">  167</span>        <span class="keywordflow">return</span> value</div>
<div class="line"><span class="lineno">  168</span>    <span class="keywordflow">except</span> ValueError <span class="keyword">as</span> e:</div>
<div class="line"><span class="lineno">  169</span>        <span class="keywordflow">raise</span> click.BadParameter(<span class="stringliteral">&quot;{}&quot;</span>.format(e))</div>
<div class="line"><span class="lineno">  170</span> </div>
<div class="line"><span class="lineno">  171</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a9fb80e8878af709e9681bb57c4dc937c" name="a9fb80e8878af709e9681bb57c4dc937c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9fb80e8878af709e9681bb57c4dc937c">&#9670;&#160;</a></span>verify()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">verify </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>key</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>imgfile</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="imgtool_2main_8py_source.html#l00143">143</a> of file <a class="el" href="imgtool_2main_8py_source.html">main.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  143</span><span class="keyword">def </span>verify(key, imgfile):</div>
<div class="line"><span class="lineno">  144</span>    key = load_key(key) <span class="keywordflow">if</span> key <span class="keywordflow">else</span> <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno">  145</span>    ret, version, digest = image.Image.verify(imgfile, key)</div>
<div class="line"><span class="lineno">  146</span>    <span class="keywordflow">if</span> ret == image.VerifyResult.OK:</div>
<div class="line"><span class="lineno">  147</span>        print(<span class="stringliteral">&quot;Image was correctly validated&quot;</span>)</div>
<div class="line"><span class="lineno">  148</span>        print(<span class="stringliteral">&quot;Image version: {}.{}.{}+{}&quot;</span>.format(*version))</div>
<div class="line"><span class="lineno">  149</span>        print(<span class="stringliteral">&quot;Image digest: {}&quot;</span>.format(digest.hex()))</div>
<div class="line"><span class="lineno">  150</span>        <span class="keywordflow">return</span></div>
<div class="line"><span class="lineno">  151</span>    <span class="keywordflow">elif</span> ret == image.VerifyResult.INVALID_MAGIC:</div>
<div class="line"><span class="lineno">  152</span>        print(<span class="stringliteral">&quot;Invalid image magic; is this an MCUboot image?&quot;</span>)</div>
<div class="line"><span class="lineno">  153</span>    <span class="keywordflow">elif</span> ret == image.VerifyResult.INVALID_TLV_INFO_MAGIC:</div>
<div class="line"><span class="lineno">  154</span>        print(<span class="stringliteral">&quot;Invalid TLV info magic; is this an MCUboot image?&quot;</span>)</div>
<div class="line"><span class="lineno">  155</span>    <span class="keywordflow">elif</span> ret == image.VerifyResult.INVALID_HASH:</div>
<div class="line"><span class="lineno">  156</span>        print(<span class="stringliteral">&quot;Image has an invalid sha256 digest&quot;</span>)</div>
<div class="line"><span class="lineno">  157</span>    <span class="keywordflow">elif</span> ret == image.VerifyResult.INVALID_SIGNATURE:</div>
<div class="line"><span class="lineno">  158</span>        print(<span class="stringliteral">&quot;No signature found for the given key&quot;</span>)</div>
<div class="line"><span class="lineno">  159</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  160</span>        print(<span class="stringliteral">&quot;Unknown return code: {}&quot;</span>.format(ret))</div>
<div class="line"><span class="lineno">  161</span>    sys.exit(1)</div>
<div class="line"><span class="lineno">  162</span> </div>
<div class="line"><span class="lineno">  163</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a6080dae0886626b9a4cedb29240708b1" name="a6080dae0886626b9a4cedb29240708b1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6080dae0886626b9a4cedb29240708b1">&#9670;&#160;</a></span>version()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">version </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="imgtool_2main_8py_source.html#l00385">385</a> of file <a class="el" href="imgtool_2main_8py_source.html">main.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  385</span><span class="keyword">def </span>version():</div>
<div class="line"><span class="lineno">  386</span>    print(imgtool_version)</div>
<div class="line"><span class="lineno">  387</span> </div>
<div class="line"><span class="lineno">  388</span> </div>
<div class="line"><span class="lineno">  389</span><span class="preprocessor">@click.command</span>(cls=AliasesGroup,</div>
<div class="line"><span class="lineno">  390</span>               context_settings=dict(help_option_names=[<span class="stringliteral">&#39;-h&#39;</span>, <span class="stringliteral">&#39;--help&#39;</span>]))</div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a98d51dd5d8978724911620f66d76e2ec" name="a98d51dd5d8978724911620f66d76e2ec"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a98d51dd5d8978724911620f66d76e2ec">&#9670;&#160;</a></span>keygens</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">dict keygens</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line"><span class="lineno">    1</span>=  {</div>
<div class="line"><span class="lineno">    2</span>    <span class="stringliteral">&#39;rsa-2048&#39;</span>:   gen_rsa2048,</div>
<div class="line"><span class="lineno">    3</span>    <span class="stringliteral">&#39;rsa-3072&#39;</span>:   gen_rsa3072,</div>
<div class="line"><span class="lineno">    4</span>    <span class="stringliteral">&#39;ecdsa-p256&#39;</span>: gen_ecdsa_p256,</div>
<div class="line"><span class="lineno">    5</span>    <span class="stringliteral">&#39;ecdsa-p224&#39;</span>: gen_ecdsa_p224,</div>
<div class="line"><span class="lineno">    6</span>    <span class="stringliteral">&#39;ed25519&#39;</span>:    gen_ed25519,</div>
<div class="line"><span class="lineno">    7</span>    <span class="stringliteral">&#39;x25519&#39;</span>:     gen_x25519,</div>
<div class="line"><span class="lineno">    8</span>}</div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="imgtool_2main_8py_source.html#l00062">62</a> of file <a class="el" href="imgtool_2main_8py_source.html">main.py</a>.</p>

</div>
</div>
<a id="aac9619ab98886780dde2f5acb6c247a5" name="aac9619ab98886780dde2f5acb6c247a5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aac9619ab98886780dde2f5acb6c247a5">&#9670;&#160;</a></span>MIN_PYTHON_VERSION</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">tuple MIN_PYTHON_VERSION = (3, 6)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="imgtool_2main_8py_source.html#l00030">30</a> of file <a class="el" href="imgtool_2main_8py_source.html">main.py</a>.</p>

</div>
</div>
<a id="a1099a5c5707ff657c8d8cff4d271e982" name="a1099a5c5707ff657c8d8cff4d271e982"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1099a5c5707ff657c8d8cff4d271e982">&#9670;&#160;</a></span>valid_langs</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">list valid_langs = ['c', 'rust']</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="imgtool_2main_8py_source.html#l00061">61</a> of file <a class="el" href="imgtool_2main_8py_source.html">main.py</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespaceimgtool.html">imgtool</a></li><li class="navelem"><a class="el" href="namespaceimgtool_1_1main.html">main</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.10.0 </li>
  </ul>
</div>
</body>
</html>
