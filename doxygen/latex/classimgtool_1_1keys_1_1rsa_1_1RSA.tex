\doxysection{RSA Class Reference}
\hypertarget{classimgtool_1_1keys_1_1rsa_1_1RSA}{}\label{classimgtool_1_1keys_1_1rsa_1_1RSA}\index{RSA@{RSA}}
Inheritance diagram for RSA\+:\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=4.375000cm]{classimgtool_1_1keys_1_1rsa_1_1RSA}
\end{center}
\end{figure}
\doxysubsubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{classimgtool_1_1keys_1_1rsa_1_1RSA_a3b1a5307863aa2b5f58c5ba7f93b26ef}{\+\_\+\+\_\+init\+\_\+\+\_\+}} (self, \mbox{\hyperlink{classimgtool_1_1keys_1_1rsa_1_1RSA_ab0d96f9d852c2058c2546a1338e87544}{key}})
\item 
\mbox{\hyperlink{classimgtool_1_1keys_1_1rsa_1_1RSA_a0d7279938bc7fc6403753ce6fb82533f}{get\+\_\+private\+\_\+bytes}} (self, minimal)
\item 
\mbox{\hyperlink{classimgtool_1_1keys_1_1rsa_1_1RSA_a0d4ec5a8b76f84fdb1d8213fdb6a2c78}{export\+\_\+private}} (self, path, passwd=None)
\item 
\mbox{\hyperlink{classimgtool_1_1keys_1_1rsa_1_1RSA_a24b586de7f74a80c50504a8d07c49657}{sign}} (self, payload)
\item 
\mbox{\hyperlink{classimgtool_1_1keys_1_1rsa_1_1RSA_a3b1a5307863aa2b5f58c5ba7f93b26ef}{\+\_\+\+\_\+init\+\_\+\+\_\+}} (self, \mbox{\hyperlink{classimgtool_1_1keys_1_1rsa_1_1RSA_ab0d96f9d852c2058c2546a1338e87544}{key}})
\item 
\mbox{\hyperlink{classimgtool_1_1keys_1_1rsa_1_1RSA_a0d7279938bc7fc6403753ce6fb82533f}{get\+\_\+private\+\_\+bytes}} (self, minimal)
\item 
\mbox{\hyperlink{classimgtool_1_1keys_1_1rsa_1_1RSA_a0d4ec5a8b76f84fdb1d8213fdb6a2c78}{export\+\_\+private}} (self, path, passwd=None)
\item 
\mbox{\hyperlink{classimgtool_1_1keys_1_1rsa_1_1RSA_a24b586de7f74a80c50504a8d07c49657}{sign}} (self, payload)
\end{DoxyCompactItemize}
\doxysubsection*{Public Member Functions inherited from \mbox{\hyperlink{classimgtool_1_1keys_1_1rsa_1_1RSAPublic}{RSAPublic}}}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{classimgtool_1_1keys_1_1rsa_1_1RSAPublic_a215877a1fc24d47624f34429a0c3eaa6}{key\+\_\+size}} (self)
\item 
\mbox{\hyperlink{classimgtool_1_1keys_1_1rsa_1_1RSAPublic_a679b02993530b144467de0a7397be2a5}{shortname}} (self)
\item 
\mbox{\hyperlink{classimgtool_1_1keys_1_1rsa_1_1RSAPublic_a9885df5cc7eddd1a3bca59e7ce7a6e5b}{get\+\_\+public\+\_\+bytes}} (self)
\item 
\mbox{\hyperlink{classimgtool_1_1keys_1_1rsa_1_1RSAPublic_ab58c8ea143a002c4d4788e7406f77143}{export\+\_\+public}} (self, path)
\item 
\mbox{\hyperlink{classimgtool_1_1keys_1_1rsa_1_1RSAPublic_a84b417b306f304e00f2018232a3e46bd}{sig\+\_\+type}} (self)
\item 
\mbox{\hyperlink{classimgtool_1_1keys_1_1rsa_1_1RSAPublic_a741661b3e7446415336cad614b39f40c}{sig\+\_\+tlv}} (self)
\item 
\mbox{\hyperlink{classimgtool_1_1keys_1_1rsa_1_1RSAPublic_a582808921e325e62f559a81a4d2d811b}{sig\+\_\+len}} (self)
\item 
\mbox{\hyperlink{classimgtool_1_1keys_1_1rsa_1_1RSAPublic_aa697b47e78a2dee86de9c506a7f6a4cc}{verify}} (self, signature, payload)
\item 
\mbox{\hyperlink{classimgtool_1_1keys_1_1rsa_1_1RSAPublic_a215877a1fc24d47624f34429a0c3eaa6}{key\+\_\+size}} (self)
\item 
\mbox{\hyperlink{classimgtool_1_1keys_1_1rsa_1_1RSAPublic_a679b02993530b144467de0a7397be2a5}{shortname}} (self)
\item 
\mbox{\hyperlink{classimgtool_1_1keys_1_1rsa_1_1RSAPublic_a9885df5cc7eddd1a3bca59e7ce7a6e5b}{get\+\_\+public\+\_\+bytes}} (self)
\item 
\mbox{\hyperlink{classimgtool_1_1keys_1_1rsa_1_1RSAPublic_ab58c8ea143a002c4d4788e7406f77143}{export\+\_\+public}} (self, path)
\item 
\mbox{\hyperlink{classimgtool_1_1keys_1_1rsa_1_1RSAPublic_a84b417b306f304e00f2018232a3e46bd}{sig\+\_\+type}} (self)
\item 
\mbox{\hyperlink{classimgtool_1_1keys_1_1rsa_1_1RSAPublic_a741661b3e7446415336cad614b39f40c}{sig\+\_\+tlv}} (self)
\item 
\mbox{\hyperlink{classimgtool_1_1keys_1_1rsa_1_1RSAPublic_a582808921e325e62f559a81a4d2d811b}{sig\+\_\+len}} (self)
\item 
\mbox{\hyperlink{classimgtool_1_1keys_1_1rsa_1_1RSAPublic_aa697b47e78a2dee86de9c506a7f6a4cc}{verify}} (self, signature, payload)
\end{DoxyCompactItemize}
\doxysubsection*{Public Member Functions inherited from \mbox{\hyperlink{classimgtool_1_1keys_1_1general_1_1KeyClass}{Key\+Class}}}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{classimgtool_1_1keys_1_1general_1_1KeyClass_ac33a4d27b29fe054efcaec0ef9a670ca}{emit\+\_\+c\+\_\+public}} (self, file=sys.\+stdout)
\item 
\mbox{\hyperlink{classimgtool_1_1keys_1_1general_1_1KeyClass_abd16208e5b61f851f9f75226e228a94a}{emit\+\_\+rust\+\_\+public}} (self, file=sys.\+stdout)
\item 
\mbox{\hyperlink{classimgtool_1_1keys_1_1general_1_1KeyClass_adabf01c1847980fa46d4373e9d29df1a}{emit\+\_\+private}} (self, minimal, file=sys.\+stdout)
\item 
\mbox{\hyperlink{classimgtool_1_1keys_1_1general_1_1KeyClass_ac33a4d27b29fe054efcaec0ef9a670ca}{emit\+\_\+c\+\_\+public}} (self, file=sys.\+stdout)
\item 
\mbox{\hyperlink{classimgtool_1_1keys_1_1general_1_1KeyClass_abd16208e5b61f851f9f75226e228a94a}{emit\+\_\+rust\+\_\+public}} (self, file=sys.\+stdout)
\item 
\mbox{\hyperlink{classimgtool_1_1keys_1_1general_1_1KeyClass_adabf01c1847980fa46d4373e9d29df1a}{emit\+\_\+private}} (self, minimal, file=sys.\+stdout)
\end{DoxyCompactItemize}
\doxysubsubsection*{Static Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{classimgtool_1_1keys_1_1rsa_1_1RSA_ab5f4282b9968f9f5ef5303ce99e5a8ce}{generate}} (\mbox{\hyperlink{classimgtool_1_1keys_1_1rsa_1_1RSAPublic_a215877a1fc24d47624f34429a0c3eaa6}{key\+\_\+size}}=2048)
\item 
\mbox{\hyperlink{classimgtool_1_1keys_1_1rsa_1_1RSA_ab5f4282b9968f9f5ef5303ce99e5a8ce}{generate}} (\mbox{\hyperlink{classimgtool_1_1keys_1_1rsa_1_1RSAPublic_a215877a1fc24d47624f34429a0c3eaa6}{key\+\_\+size}}=2048)
\end{DoxyCompactItemize}
\doxysubsubsection*{Data Fields}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{classimgtool_1_1keys_1_1rsa_1_1RSA_ab0d96f9d852c2058c2546a1338e87544}{key}}
\end{DoxyCompactItemize}
\doxysubsection*{Data Fields inherited from \mbox{\hyperlink{classimgtool_1_1keys_1_1rsa_1_1RSAPublic}{RSAPublic}}}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{classimgtool_1_1keys_1_1rsa_1_1RSAPublic_ab0d96f9d852c2058c2546a1338e87544}{key}}
\end{DoxyCompactItemize}
\doxysubsubsection*{Protected Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{classimgtool_1_1keys_1_1rsa_1_1RSA_ad44b9b51ba5244f41760ec7442292242}{\+\_\+get\+\_\+public}} (self)
\item 
\mbox{\hyperlink{classimgtool_1_1keys_1_1rsa_1_1RSA_a8a8681eef336d5ed5bbe8d458287ba96}{\+\_\+build\+\_\+minimal\+\_\+rsa\+\_\+privkey}} (self, der)
\item 
\mbox{\hyperlink{classimgtool_1_1keys_1_1rsa_1_1RSA_ad44b9b51ba5244f41760ec7442292242}{\+\_\+get\+\_\+public}} (self)
\item 
\mbox{\hyperlink{classimgtool_1_1keys_1_1rsa_1_1RSA_a8a8681eef336d5ed5bbe8d458287ba96}{\+\_\+build\+\_\+minimal\+\_\+rsa\+\_\+privkey}} (self, der)
\end{DoxyCompactItemize}
\doxysubsection*{Protected Member Functions inherited from \mbox{\hyperlink{classimgtool_1_1keys_1_1rsa_1_1RSAPublic}{RSAPublic}}}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{classimgtool_1_1keys_1_1rsa_1_1RSAPublic_adfa696342f3f85dae9fbf80b682f9dd8}{\+\_\+unsupported}} (self, name)
\item 
\mbox{\hyperlink{classimgtool_1_1keys_1_1rsa_1_1RSAPublic_adfa696342f3f85dae9fbf80b682f9dd8}{\+\_\+unsupported}} (self, name)
\end{DoxyCompactItemize}
\doxysubsection*{Protected Member Functions inherited from \mbox{\hyperlink{classimgtool_1_1keys_1_1general_1_1KeyClass}{Key\+Class}}}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{classimgtool_1_1keys_1_1general_1_1KeyClass_a447472897cce65884174dcf623590ac8}{\+\_\+emit}} (self, header, trailer, encoded\+\_\+bytes, indent, file=sys.\+stdout, len\+\_\+format=None)
\item 
\mbox{\hyperlink{classimgtool_1_1keys_1_1general_1_1KeyClass_a447472897cce65884174dcf623590ac8}{\+\_\+emit}} (self, header, trailer, encoded\+\_\+bytes, indent, file=sys.\+stdout, len\+\_\+format=None)
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
\begin{DoxyVerb}Wrapper around an RSA key, with imgtool support.
\end{DoxyVerb}
 

Definition at line \mbox{\hyperlink{keys_2rsa_8py_source_l00079}{79}} of file \mbox{\hyperlink{keys_2rsa_8py_source}{rsa.\+py}}.



\doxysubsection{Constructor \& Destructor Documentation}
\Hypertarget{classimgtool_1_1keys_1_1rsa_1_1RSA_a3b1a5307863aa2b5f58c5ba7f93b26ef}\label{classimgtool_1_1keys_1_1rsa_1_1RSA_a3b1a5307863aa2b5f58c5ba7f93b26ef} 
\index{RSA@{RSA}!\_\_init\_\_@{\_\_init\_\_}}
\index{\_\_init\_\_@{\_\_init\_\_}!RSA@{RSA}}
\doxysubsubsection{\texorpdfstring{\_\_init\_\_()}{\_\_init\_\_()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily \+\_\+\+\_\+init\+\_\+\+\_\+ (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{key }\end{DoxyParamCaption})}

\begin{DoxyVerb}The key should be a private key from cryptography\end{DoxyVerb}
 

Reimplemented from \mbox{\hyperlink{classimgtool_1_1keys_1_1rsa_1_1RSAPublic_a3b1a5307863aa2b5f58c5ba7f93b26ef}{RSAPublic}}.



Definition at line \mbox{\hyperlink{keys_2rsa_8py_source_l00084}{84}} of file \mbox{\hyperlink{keys_2rsa_8py_source}{rsa.\+py}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00084\ \ \ \ \ \textcolor{keyword}{def\ }\_\_init\_\_(self,\ key):}
\DoxyCodeLine{00085\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}The\ key\ should\ be\ a\ private\ key\ from\ cryptography"{}"{}"{}}}
\DoxyCodeLine{00086\ \ \ \ \ \ \ \ \ self.key\ =\ key}
\DoxyCodeLine{00087\ }

\end{DoxyCode}
\Hypertarget{classimgtool_1_1keys_1_1rsa_1_1RSA_a3b1a5307863aa2b5f58c5ba7f93b26ef}\label{classimgtool_1_1keys_1_1rsa_1_1RSA_a3b1a5307863aa2b5f58c5ba7f93b26ef} 
\index{RSA@{RSA}!\_\_init\_\_@{\_\_init\_\_}}
\index{\_\_init\_\_@{\_\_init\_\_}!RSA@{RSA}}
\doxysubsubsection{\texorpdfstring{\_\_init\_\_()}{\_\_init\_\_()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily \+\_\+\+\_\+init\+\_\+\+\_\+ (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{key }\end{DoxyParamCaption})}

\begin{DoxyVerb}The key should be a private key from cryptography\end{DoxyVerb}
 

Reimplemented from \mbox{\hyperlink{classimgtool_1_1keys_1_1rsa_1_1RSAPublic_a3b1a5307863aa2b5f58c5ba7f93b26ef}{RSAPublic}}.



Definition at line \mbox{\hyperlink{1_87_82_2imgtool_2keys_2rsa_8py_source_l00082}{82}} of file \mbox{\hyperlink{1_87_82_2imgtool_2keys_2rsa_8py_source}{rsa.\+py}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00082\ \ \ \ \ \textcolor{keyword}{def\ }\_\_init\_\_(self,\ key):}
\DoxyCodeLine{00083\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}The\ key\ should\ be\ a\ private\ key\ from\ cryptography"{}"{}"{}}}
\DoxyCodeLine{00084\ \ \ \ \ \ \ \ \ self.key\ =\ key}
\DoxyCodeLine{00085\ }

\end{DoxyCode}


\doxysubsection{Member Function Documentation}
\Hypertarget{classimgtool_1_1keys_1_1rsa_1_1RSA_a8a8681eef336d5ed5bbe8d458287ba96}\label{classimgtool_1_1keys_1_1rsa_1_1RSA_a8a8681eef336d5ed5bbe8d458287ba96} 
\index{RSA@{RSA}!\_build\_minimal\_rsa\_privkey@{\_build\_minimal\_rsa\_privkey}}
\index{\_build\_minimal\_rsa\_privkey@{\_build\_minimal\_rsa\_privkey}!RSA@{RSA}}
\doxysubsubsection{\texorpdfstring{\_build\_minimal\_rsa\_privkey()}{\_build\_minimal\_rsa\_privkey()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily \+\_\+build\+\_\+minimal\+\_\+rsa\+\_\+privkey (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{der }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}}

\begin{DoxyVerb}Builds a new DER that only includes N/E/D/P/Q RSA parameters;
standard DER private bytes provided by OpenSSL also includes
CRT params (DP/DQ/QP) which can be removed.
\end{DoxyVerb}
 

Definition at line \mbox{\hyperlink{keys_2rsa_8py_source_l00102}{102}} of file \mbox{\hyperlink{keys_2rsa_8py_source}{rsa.\+py}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00102\ \ \ \ \ \textcolor{keyword}{def\ }\_build\_minimal\_rsa\_privkey(self,\ der):}
\DoxyCodeLine{00103\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'''}}
\DoxyCodeLine{00104\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Builds\ a\ new\ DER\ that\ only\ includes\ N/E/D/P/Q\ RSA\ parameters;}}
\DoxyCodeLine{00105\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ standard\ DER\ private\ bytes\ provided\ by\ OpenSSL\ also\ includes}}
\DoxyCodeLine{00106\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ CRT\ params\ (DP/DQ/QP)\ which\ can\ be\ removed.}}
\DoxyCodeLine{00107\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ '''}}
\DoxyCodeLine{00108\ \ \ \ \ \ \ \ \ OFFSET\_N\ =\ 7\ \ \textcolor{comment}{\#\ N\ is\ always\ located\ at\ this\ offset}}
\DoxyCodeLine{00109\ \ \ \ \ \ \ \ \ b\ =\ bytearray(der)}
\DoxyCodeLine{00110\ \ \ \ \ \ \ \ \ off\ =\ OFFSET\_N}
\DoxyCodeLine{00111\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ b[off\ +\ 1]\ !=\ 0x82:}
\DoxyCodeLine{00112\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ RSAUsageError(\textcolor{stringliteral}{"{}Error\ parsing\ N\ while\ minimizing"{}})}
\DoxyCodeLine{00113\ \ \ \ \ \ \ \ \ len\_N\ =\ (b[off\ +\ 2]\ <<\ 8)\ +\ b[off\ +\ 3]\ +\ 4}
\DoxyCodeLine{00114\ \ \ \ \ \ \ \ \ off\ +=\ len\_N}
\DoxyCodeLine{00115\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ b[off\ +\ 1]\ !=\ 0x03:}
\DoxyCodeLine{00116\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ RSAUsageError(\textcolor{stringliteral}{"{}Error\ parsing\ E\ while\ minimizing"{}})}
\DoxyCodeLine{00117\ \ \ \ \ \ \ \ \ len\_E\ =\ b[off\ +\ 2]\ +\ 4}
\DoxyCodeLine{00118\ \ \ \ \ \ \ \ \ off\ +=\ len\_E}
\DoxyCodeLine{00119\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ b[off\ +\ 1]\ !=\ 0x82:}
\DoxyCodeLine{00120\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ RSAUsageError(\textcolor{stringliteral}{"{}Error\ parsing\ D\ while\ minimizing"{}})}
\DoxyCodeLine{00121\ \ \ \ \ \ \ \ \ len\_D\ =\ (b[off\ +\ 2]\ <<\ 8)\ +\ b[off\ +\ 3]\ +\ 4}
\DoxyCodeLine{00122\ \ \ \ \ \ \ \ \ off\ +=\ len\_D}
\DoxyCodeLine{00123\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ b[off\ +\ 1]\ !=\ 0x81:}
\DoxyCodeLine{00124\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ RSAUsageError(\textcolor{stringliteral}{"{}Error\ parsing\ P\ while\ minimizing"{}})}
\DoxyCodeLine{00125\ \ \ \ \ \ \ \ \ len\_P\ =\ b[off\ +\ 2]\ +\ 3}
\DoxyCodeLine{00126\ \ \ \ \ \ \ \ \ off\ +=\ len\_P}
\DoxyCodeLine{00127\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ b[off\ +\ 1]\ !=\ 0x81:}
\DoxyCodeLine{00128\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ RSAUsageError(\textcolor{stringliteral}{"{}Error\ parsing\ Q\ while\ minimizing"{}})}
\DoxyCodeLine{00129\ \ \ \ \ \ \ \ \ len\_Q\ =\ b[off\ +\ 2]\ +\ 3}
\DoxyCodeLine{00130\ \ \ \ \ \ \ \ \ off\ +=\ len\_Q}
\DoxyCodeLine{00131\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ adjust\ DER\ size\ for\ removed\ elements}}
\DoxyCodeLine{00132\ \ \ \ \ \ \ \ \ b[2]\ =\ (off\ -\/\ 4)\ >>\ 8}
\DoxyCodeLine{00133\ \ \ \ \ \ \ \ \ b[3]\ =\ (off\ -\/\ 4)\ \&\ 0xff}
\DoxyCodeLine{00134\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ b[:off]}
\DoxyCodeLine{00135\ }

\end{DoxyCode}
\Hypertarget{classimgtool_1_1keys_1_1rsa_1_1RSA_a8a8681eef336d5ed5bbe8d458287ba96}\label{classimgtool_1_1keys_1_1rsa_1_1RSA_a8a8681eef336d5ed5bbe8d458287ba96} 
\index{RSA@{RSA}!\_build\_minimal\_rsa\_privkey@{\_build\_minimal\_rsa\_privkey}}
\index{\_build\_minimal\_rsa\_privkey@{\_build\_minimal\_rsa\_privkey}!RSA@{RSA}}
\doxysubsubsection{\texorpdfstring{\_build\_minimal\_rsa\_privkey()}{\_build\_minimal\_rsa\_privkey()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily \+\_\+build\+\_\+minimal\+\_\+rsa\+\_\+privkey (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{der }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}}

\begin{DoxyVerb}Builds a new DER that only includes N/E/D/P/Q RSA parameters;
standard DER private bytes provided by OpenSSL also includes
CRT params (DP/DQ/QP) which can be removed.
\end{DoxyVerb}
 

Definition at line \mbox{\hyperlink{1_87_82_2imgtool_2keys_2rsa_8py_source_l00100}{100}} of file \mbox{\hyperlink{1_87_82_2imgtool_2keys_2rsa_8py_source}{rsa.\+py}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00100\ \ \ \ \ \textcolor{keyword}{def\ }\_build\_minimal\_rsa\_privkey(self,\ der):}
\DoxyCodeLine{00101\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'''}}
\DoxyCodeLine{00102\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Builds\ a\ new\ DER\ that\ only\ includes\ N/E/D/P/Q\ RSA\ parameters;}}
\DoxyCodeLine{00103\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ standard\ DER\ private\ bytes\ provided\ by\ OpenSSL\ also\ includes}}
\DoxyCodeLine{00104\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ CRT\ params\ (DP/DQ/QP)\ which\ can\ be\ removed.}}
\DoxyCodeLine{00105\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ '''}}
\DoxyCodeLine{00106\ \ \ \ \ \ \ \ \ OFFSET\_N\ =\ 7\ \ \textcolor{comment}{\#\ N\ is\ always\ located\ at\ this\ offset}}
\DoxyCodeLine{00107\ \ \ \ \ \ \ \ \ b\ =\ bytearray(der)}
\DoxyCodeLine{00108\ \ \ \ \ \ \ \ \ off\ =\ OFFSET\_N}
\DoxyCodeLine{00109\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ b[off\ +\ 1]\ !=\ 0x82:}
\DoxyCodeLine{00110\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ RSAUsageError(\textcolor{stringliteral}{"{}Error\ parsing\ N\ while\ minimizing"{}})}
\DoxyCodeLine{00111\ \ \ \ \ \ \ \ \ len\_N\ =\ (b[off\ +\ 2]\ <<\ 8)\ +\ b[off\ +\ 3]\ +\ 4}
\DoxyCodeLine{00112\ \ \ \ \ \ \ \ \ off\ +=\ len\_N}
\DoxyCodeLine{00113\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ b[off\ +\ 1]\ !=\ 0x03:}
\DoxyCodeLine{00114\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ RSAUsageError(\textcolor{stringliteral}{"{}Error\ parsing\ E\ while\ minimizing"{}})}
\DoxyCodeLine{00115\ \ \ \ \ \ \ \ \ len\_E\ =\ b[off\ +\ 2]\ +\ 4}
\DoxyCodeLine{00116\ \ \ \ \ \ \ \ \ off\ +=\ len\_E}
\DoxyCodeLine{00117\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ b[off\ +\ 1]\ !=\ 0x82:}
\DoxyCodeLine{00118\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ RSAUsageError(\textcolor{stringliteral}{"{}Error\ parsing\ D\ while\ minimizing"{}})}
\DoxyCodeLine{00119\ \ \ \ \ \ \ \ \ len\_D\ =\ (b[off\ +\ 2]\ <<\ 8)\ +\ b[off\ +\ 3]\ +\ 4}
\DoxyCodeLine{00120\ \ \ \ \ \ \ \ \ off\ +=\ len\_D}
\DoxyCodeLine{00121\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ b[off\ +\ 1]\ !=\ 0x81:}
\DoxyCodeLine{00122\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ RSAUsageError(\textcolor{stringliteral}{"{}Error\ parsing\ P\ while\ minimizing"{}})}
\DoxyCodeLine{00123\ \ \ \ \ \ \ \ \ len\_P\ =\ b[off\ +\ 2]\ +\ 3}
\DoxyCodeLine{00124\ \ \ \ \ \ \ \ \ off\ +=\ len\_P}
\DoxyCodeLine{00125\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ b[off\ +\ 1]\ !=\ 0x81:}
\DoxyCodeLine{00126\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ RSAUsageError(\textcolor{stringliteral}{"{}Error\ parsing\ Q\ while\ minimizing"{}})}
\DoxyCodeLine{00127\ \ \ \ \ \ \ \ \ len\_Q\ =\ b[off\ +\ 2]\ +\ 3}
\DoxyCodeLine{00128\ \ \ \ \ \ \ \ \ off\ +=\ len\_Q}
\DoxyCodeLine{00129\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ adjust\ DER\ size\ for\ removed\ elements}}
\DoxyCodeLine{00130\ \ \ \ \ \ \ \ \ b[2]\ =\ (off\ -\/\ 4)\ >>\ 8}
\DoxyCodeLine{00131\ \ \ \ \ \ \ \ \ b[3]\ =\ (off\ -\/\ 4)\ \&\ 0xff}
\DoxyCodeLine{00132\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ b[:off]}
\DoxyCodeLine{00133\ }

\end{DoxyCode}
\Hypertarget{classimgtool_1_1keys_1_1rsa_1_1RSA_ad44b9b51ba5244f41760ec7442292242}\label{classimgtool_1_1keys_1_1rsa_1_1RSA_ad44b9b51ba5244f41760ec7442292242} 
\index{RSA@{RSA}!\_get\_public@{\_get\_public}}
\index{\_get\_public@{\_get\_public}!RSA@{RSA}}
\doxysubsubsection{\texorpdfstring{\_get\_public()}{\_get\_public()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily \+\_\+get\+\_\+public (\begin{DoxyParamCaption}\item[{}]{self }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}}



Reimplemented from \mbox{\hyperlink{classimgtool_1_1keys_1_1rsa_1_1RSAPublic_ad44b9b51ba5244f41760ec7442292242}{RSAPublic}}.



Definition at line \mbox{\hyperlink{keys_2rsa_8py_source_l00099}{99}} of file \mbox{\hyperlink{keys_2rsa_8py_source}{rsa.\+py}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00099\ \ \ \ \ \textcolor{keyword}{def\ }\_get\_public(self):}
\DoxyCodeLine{00100\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ self.key.public\_key()}
\DoxyCodeLine{00101\ }

\end{DoxyCode}
\Hypertarget{classimgtool_1_1keys_1_1rsa_1_1RSA_ad44b9b51ba5244f41760ec7442292242}\label{classimgtool_1_1keys_1_1rsa_1_1RSA_ad44b9b51ba5244f41760ec7442292242} 
\index{RSA@{RSA}!\_get\_public@{\_get\_public}}
\index{\_get\_public@{\_get\_public}!RSA@{RSA}}
\doxysubsubsection{\texorpdfstring{\_get\_public()}{\_get\_public()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily \+\_\+get\+\_\+public (\begin{DoxyParamCaption}\item[{}]{self }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}}



Reimplemented from \mbox{\hyperlink{classimgtool_1_1keys_1_1rsa_1_1RSAPublic_ad44b9b51ba5244f41760ec7442292242}{RSAPublic}}.



Definition at line \mbox{\hyperlink{1_87_82_2imgtool_2keys_2rsa_8py_source_l00097}{97}} of file \mbox{\hyperlink{1_87_82_2imgtool_2keys_2rsa_8py_source}{rsa.\+py}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00097\ \ \ \ \ \textcolor{keyword}{def\ }\_get\_public(self):}
\DoxyCodeLine{00098\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ self.key.public\_key()}
\DoxyCodeLine{00099\ }

\end{DoxyCode}
\Hypertarget{classimgtool_1_1keys_1_1rsa_1_1RSA_a0d4ec5a8b76f84fdb1d8213fdb6a2c78}\label{classimgtool_1_1keys_1_1rsa_1_1RSA_a0d4ec5a8b76f84fdb1d8213fdb6a2c78} 
\index{RSA@{RSA}!export\_private@{export\_private}}
\index{export\_private@{export\_private}!RSA@{RSA}}
\doxysubsubsection{\texorpdfstring{export\_private()}{export\_private()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily export\+\_\+private (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{path,  }\item[{}]{passwd = {\ttfamily None} }\end{DoxyParamCaption})}

\begin{DoxyVerb}Write the private key to the given file, protecting it with the
optional password.\end{DoxyVerb}
 

Reimplemented from \mbox{\hyperlink{classimgtool_1_1keys_1_1rsa_1_1RSAPublic_a0d4ec5a8b76f84fdb1d8213fdb6a2c78}{RSAPublic}}.



Definition at line \mbox{\hyperlink{keys_2rsa_8py_source_l00145}{145}} of file \mbox{\hyperlink{keys_2rsa_8py_source}{rsa.\+py}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00145\ \ \ \ \ \textcolor{keyword}{def\ }export\_private(self,\ path,\ passwd=None):}
\DoxyCodeLine{00146\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Write\ the\ private\ key\ to\ the\ given\ file,\ protecting\ it\ with\ the}}
\DoxyCodeLine{00147\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ optional\ password."{}"{}"{}}}
\DoxyCodeLine{00148\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ passwd\ \textcolor{keywordflow}{is}\ \textcolor{keywordtype}{None}:}
\DoxyCodeLine{00149\ \ \ \ \ \ \ \ \ \ \ \ \ enc\ =\ serialization.NoEncryption()}
\DoxyCodeLine{00150\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{00151\ \ \ \ \ \ \ \ \ \ \ \ \ enc\ =\ serialization.BestAvailableEncryption(passwd)}
\DoxyCodeLine{00152\ \ \ \ \ \ \ \ \ pem\ =\ self.key.private\_bytes(}
\DoxyCodeLine{00153\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ encoding=serialization.Encoding.PEM,}
\DoxyCodeLine{00154\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ format=serialization.PrivateFormat.PKCS8,}
\DoxyCodeLine{00155\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ encryption\_algorithm=enc)}
\DoxyCodeLine{00156\ \ \ \ \ \ \ \ \ \textcolor{keyword}{with}\ open(path,\ \textcolor{stringliteral}{'wb'})\ \textcolor{keyword}{as}\ f:}
\DoxyCodeLine{00157\ \ \ \ \ \ \ \ \ \ \ \ \ f.write(pem)}
\DoxyCodeLine{00158\ }

\end{DoxyCode}
\Hypertarget{classimgtool_1_1keys_1_1rsa_1_1RSA_a0d4ec5a8b76f84fdb1d8213fdb6a2c78}\label{classimgtool_1_1keys_1_1rsa_1_1RSA_a0d4ec5a8b76f84fdb1d8213fdb6a2c78} 
\index{RSA@{RSA}!export\_private@{export\_private}}
\index{export\_private@{export\_private}!RSA@{RSA}}
\doxysubsubsection{\texorpdfstring{export\_private()}{export\_private()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily export\+\_\+private (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{path,  }\item[{}]{passwd = {\ttfamily None} }\end{DoxyParamCaption})}

\begin{DoxyVerb}Write the private key to the given file, protecting it with the
optional password.\end{DoxyVerb}
 

Reimplemented from \mbox{\hyperlink{classimgtool_1_1keys_1_1rsa_1_1RSAPublic_a0d4ec5a8b76f84fdb1d8213fdb6a2c78}{RSAPublic}}.



Definition at line \mbox{\hyperlink{1_87_82_2imgtool_2keys_2rsa_8py_source_l00143}{143}} of file \mbox{\hyperlink{1_87_82_2imgtool_2keys_2rsa_8py_source}{rsa.\+py}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00143\ \ \ \ \ \textcolor{keyword}{def\ }export\_private(self,\ path,\ passwd=None):}
\DoxyCodeLine{00144\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Write\ the\ private\ key\ to\ the\ given\ file,\ protecting\ it\ with\ the}}
\DoxyCodeLine{00145\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ optional\ password."{}"{}"{}}}
\DoxyCodeLine{00146\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ passwd\ \textcolor{keywordflow}{is}\ \textcolor{keywordtype}{None}:}
\DoxyCodeLine{00147\ \ \ \ \ \ \ \ \ \ \ \ \ enc\ =\ serialization.NoEncryption()}
\DoxyCodeLine{00148\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{00149\ \ \ \ \ \ \ \ \ \ \ \ \ enc\ =\ serialization.BestAvailableEncryption(passwd)}
\DoxyCodeLine{00150\ \ \ \ \ \ \ \ \ pem\ =\ self.key.private\_bytes(}
\DoxyCodeLine{00151\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ encoding=serialization.Encoding.PEM,}
\DoxyCodeLine{00152\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ format=serialization.PrivateFormat.PKCS8,}
\DoxyCodeLine{00153\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ encryption\_algorithm=enc)}
\DoxyCodeLine{00154\ \ \ \ \ \ \ \ \ \textcolor{keyword}{with}\ open(path,\ \textcolor{stringliteral}{'wb'})\ \textcolor{keyword}{as}\ f:}
\DoxyCodeLine{00155\ \ \ \ \ \ \ \ \ \ \ \ \ f.write(pem)}
\DoxyCodeLine{00156\ }

\end{DoxyCode}
\Hypertarget{classimgtool_1_1keys_1_1rsa_1_1RSA_ab5f4282b9968f9f5ef5303ce99e5a8ce}\label{classimgtool_1_1keys_1_1rsa_1_1RSA_ab5f4282b9968f9f5ef5303ce99e5a8ce} 
\index{RSA@{RSA}!generate@{generate}}
\index{generate@{generate}!RSA@{RSA}}
\doxysubsubsection{\texorpdfstring{generate()}{generate()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily generate (\begin{DoxyParamCaption}\item[{}]{key\+\_\+size = {\ttfamily 2048} }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



Definition at line \mbox{\hyperlink{keys_2rsa_8py_source_l00089}{89}} of file \mbox{\hyperlink{keys_2rsa_8py_source}{rsa.\+py}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00089\ \ \ \ \ \textcolor{keyword}{def\ }generate(key\_size=2048):}
\DoxyCodeLine{00090\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ key\_size\ \textcolor{keywordflow}{not}\ \textcolor{keywordflow}{in}\ RSA\_KEY\_SIZES:}
\DoxyCodeLine{00091\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ RSAUsageError(\textcolor{stringliteral}{"{}Key\ size\ \{\}\ is\ not\ supported\ by\ MCUboot"{}}}
\DoxyCodeLine{00092\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ .format(key\_size))}
\DoxyCodeLine{00093\ \ \ \ \ \ \ \ \ pk\ =\ rsa.generate\_private\_key(}
\DoxyCodeLine{00094\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ public\_exponent=65537,}
\DoxyCodeLine{00095\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ key\_size=key\_size,}
\DoxyCodeLine{00096\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ backend=default\_backend())}
\DoxyCodeLine{00097\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ RSA(pk)}
\DoxyCodeLine{00098\ }

\end{DoxyCode}
\Hypertarget{classimgtool_1_1keys_1_1rsa_1_1RSA_ab5f4282b9968f9f5ef5303ce99e5a8ce}\label{classimgtool_1_1keys_1_1rsa_1_1RSA_ab5f4282b9968f9f5ef5303ce99e5a8ce} 
\index{RSA@{RSA}!generate@{generate}}
\index{generate@{generate}!RSA@{RSA}}
\doxysubsubsection{\texorpdfstring{generate()}{generate()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily generate (\begin{DoxyParamCaption}\item[{}]{key\+\_\+size = {\ttfamily 2048} }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



Definition at line \mbox{\hyperlink{1_87_82_2imgtool_2keys_2rsa_8py_source_l00087}{87}} of file \mbox{\hyperlink{1_87_82_2imgtool_2keys_2rsa_8py_source}{rsa.\+py}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00087\ \ \ \ \ \textcolor{keyword}{def\ }generate(key\_size=2048):}
\DoxyCodeLine{00088\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ key\_size\ \textcolor{keywordflow}{not}\ \textcolor{keywordflow}{in}\ RSA\_KEY\_SIZES:}
\DoxyCodeLine{00089\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ RSAUsageError(\textcolor{stringliteral}{"{}Key\ size\ \{\}\ is\ not\ supported\ by\ MCUboot"{}}}
\DoxyCodeLine{00090\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ .format(key\_size))}
\DoxyCodeLine{00091\ \ \ \ \ \ \ \ \ pk\ =\ rsa.generate\_private\_key(}
\DoxyCodeLine{00092\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ public\_exponent=65537,}
\DoxyCodeLine{00093\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ key\_size=key\_size,}
\DoxyCodeLine{00094\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ backend=default\_backend())}
\DoxyCodeLine{00095\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ RSA(pk)}
\DoxyCodeLine{00096\ }

\end{DoxyCode}
\Hypertarget{classimgtool_1_1keys_1_1rsa_1_1RSA_a0d7279938bc7fc6403753ce6fb82533f}\label{classimgtool_1_1keys_1_1rsa_1_1RSA_a0d7279938bc7fc6403753ce6fb82533f} 
\index{RSA@{RSA}!get\_private\_bytes@{get\_private\_bytes}}
\index{get\_private\_bytes@{get\_private\_bytes}!RSA@{RSA}}
\doxysubsubsection{\texorpdfstring{get\_private\_bytes()}{get\_private\_bytes()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily get\+\_\+private\+\_\+bytes (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{minimal }\end{DoxyParamCaption})}



Reimplemented from \mbox{\hyperlink{classimgtool_1_1keys_1_1rsa_1_1RSAPublic_a0d7279938bc7fc6403753ce6fb82533f}{RSAPublic}}.



Definition at line \mbox{\hyperlink{keys_2rsa_8py_source_l00136}{136}} of file \mbox{\hyperlink{keys_2rsa_8py_source}{rsa.\+py}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00136\ \ \ \ \ \textcolor{keyword}{def\ }get\_private\_bytes(self,\ minimal):}
\DoxyCodeLine{00137\ \ \ \ \ \ \ \ \ priv\ =\ self.key.private\_bytes(}
\DoxyCodeLine{00138\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ encoding=serialization.Encoding.DER,}
\DoxyCodeLine{00139\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ format=serialization.PrivateFormat.TraditionalOpenSSL,}
\DoxyCodeLine{00140\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ encryption\_algorithm=serialization.NoEncryption())}
\DoxyCodeLine{00141\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ minimal:}
\DoxyCodeLine{00142\ \ \ \ \ \ \ \ \ \ \ \ \ priv\ =\ self.\_build\_minimal\_rsa\_privkey(priv)}
\DoxyCodeLine{00143\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ priv}
\DoxyCodeLine{00144\ }

\end{DoxyCode}
\Hypertarget{classimgtool_1_1keys_1_1rsa_1_1RSA_a0d7279938bc7fc6403753ce6fb82533f}\label{classimgtool_1_1keys_1_1rsa_1_1RSA_a0d7279938bc7fc6403753ce6fb82533f} 
\index{RSA@{RSA}!get\_private\_bytes@{get\_private\_bytes}}
\index{get\_private\_bytes@{get\_private\_bytes}!RSA@{RSA}}
\doxysubsubsection{\texorpdfstring{get\_private\_bytes()}{get\_private\_bytes()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily get\+\_\+private\+\_\+bytes (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{minimal }\end{DoxyParamCaption})}



Reimplemented from \mbox{\hyperlink{classimgtool_1_1keys_1_1rsa_1_1RSAPublic_a0d7279938bc7fc6403753ce6fb82533f}{RSAPublic}}.



Definition at line \mbox{\hyperlink{1_87_82_2imgtool_2keys_2rsa_8py_source_l00134}{134}} of file \mbox{\hyperlink{1_87_82_2imgtool_2keys_2rsa_8py_source}{rsa.\+py}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00134\ \ \ \ \ \textcolor{keyword}{def\ }get\_private\_bytes(self,\ minimal):}
\DoxyCodeLine{00135\ \ \ \ \ \ \ \ \ priv\ =\ self.key.private\_bytes(}
\DoxyCodeLine{00136\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ encoding=serialization.Encoding.DER,}
\DoxyCodeLine{00137\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ format=serialization.PrivateFormat.TraditionalOpenSSL,}
\DoxyCodeLine{00138\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ encryption\_algorithm=serialization.NoEncryption())}
\DoxyCodeLine{00139\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ minimal:}
\DoxyCodeLine{00140\ \ \ \ \ \ \ \ \ \ \ \ \ priv\ =\ self.\_build\_minimal\_rsa\_privkey(priv)}
\DoxyCodeLine{00141\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ priv}
\DoxyCodeLine{00142\ }

\end{DoxyCode}
\Hypertarget{classimgtool_1_1keys_1_1rsa_1_1RSA_a24b586de7f74a80c50504a8d07c49657}\label{classimgtool_1_1keys_1_1rsa_1_1RSA_a24b586de7f74a80c50504a8d07c49657} 
\index{RSA@{RSA}!sign@{sign}}
\index{sign@{sign}!RSA@{RSA}}
\doxysubsubsection{\texorpdfstring{sign()}{sign()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily sign (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{payload }\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{keys_2rsa_8py_source_l00159}{159}} of file \mbox{\hyperlink{keys_2rsa_8py_source}{rsa.\+py}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00159\ \ \ \ \ \textcolor{keyword}{def\ }sign(self,\ payload):}
\DoxyCodeLine{00160\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ The\ verification\ code\ only\ allows\ the\ salt\ length\ to\ be\ the}}
\DoxyCodeLine{00161\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ same\ as\ the\ hash\ length,\ 32.}}
\DoxyCodeLine{00162\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ self.key.sign(}
\DoxyCodeLine{00163\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ data=payload,}
\DoxyCodeLine{00164\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ padding=PSS(mgf=MGF1(SHA256()),\ salt\_length=32),}
\DoxyCodeLine{00165\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ algorithm=SHA256())}

\end{DoxyCode}
\Hypertarget{classimgtool_1_1keys_1_1rsa_1_1RSA_a24b586de7f74a80c50504a8d07c49657}\label{classimgtool_1_1keys_1_1rsa_1_1RSA_a24b586de7f74a80c50504a8d07c49657} 
\index{RSA@{RSA}!sign@{sign}}
\index{sign@{sign}!RSA@{RSA}}
\doxysubsubsection{\texorpdfstring{sign()}{sign()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily sign (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{payload }\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{1_87_82_2imgtool_2keys_2rsa_8py_source_l00157}{157}} of file \mbox{\hyperlink{1_87_82_2imgtool_2keys_2rsa_8py_source}{rsa.\+py}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00157\ \ \ \ \ \textcolor{keyword}{def\ }sign(self,\ payload):}
\DoxyCodeLine{00158\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ The\ verification\ code\ only\ allows\ the\ salt\ length\ to\ be\ the}}
\DoxyCodeLine{00159\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ same\ as\ the\ hash\ length,\ 32.}}
\DoxyCodeLine{00160\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ self.key.sign(}
\DoxyCodeLine{00161\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ data=payload,}
\DoxyCodeLine{00162\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ padding=PSS(mgf=MGF1(SHA256()),\ salt\_length=32),}
\DoxyCodeLine{00163\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ algorithm=SHA256())}

\end{DoxyCode}


\doxysubsection{Field Documentation}
\Hypertarget{classimgtool_1_1keys_1_1rsa_1_1RSA_ab0d96f9d852c2058c2546a1338e87544}\label{classimgtool_1_1keys_1_1rsa_1_1RSA_ab0d96f9d852c2058c2546a1338e87544} 
\index{RSA@{RSA}!key@{key}}
\index{key@{key}!RSA@{RSA}}
\doxysubsubsection{\texorpdfstring{key}{key}}
{\footnotesize\ttfamily key}



Definition at line \mbox{\hyperlink{keys_2rsa_8py_source_l00086}{86}} of file \mbox{\hyperlink{keys_2rsa_8py_source}{rsa.\+py}}.



The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
/home/harrkout/github/\+Leshan-\/\+OMA-\/\+Lightweight-\/\+M2\+M-\/server-\/for-\/\+Zephyr-\//scripts/imgtool/keys/\mbox{\hyperlink{keys_2rsa_8py}{rsa.\+py}}\item 
/home/harrkout/github/\+Leshan-\/\+OMA-\/\+Lightweight-\/\+M2\+M-\/server-\/for-\/\+Zephyr-\//scripts/imgtool\+\_\+1.\+7.\+2/imgtool/keys/\mbox{\hyperlink{1_87_82_2imgtool_2keys_2rsa_8py}{rsa.\+py}}\end{DoxyCompactItemize}
