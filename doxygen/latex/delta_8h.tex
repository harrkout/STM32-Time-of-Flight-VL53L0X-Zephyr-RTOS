\doxysection{/home/harrkout/github/\+Leshan-\/\+OMA-\/\+Lightweight-\/\+M2\+M-\/server-\/for-\/\+Zephyr-\//src/delta/delta.h File Reference}
\hypertarget{delta_8h}{}\label{delta_8h}\index{/home/harrkout/github/Leshan-\/OMA-\/Lightweight-\/M2M-\/server-\/for-\/Zephyr-\//src/delta/delta.h@{/home/harrkout/github/Leshan-\/OMA-\/Lightweight-\/M2M-\/server-\/for-\/Zephyr-\//src/delta/delta.h}}
{\ttfamily \#include $<$zephyr.\+h$>$}\newline
{\ttfamily \#include $<$sys/util.\+h$>$}\newline
{\ttfamily \#include $<$device.\+h$>$}\newline
{\ttfamily \#include $<$devicetree.\+h$>$}\newline
{\ttfamily \#include $<$drivers/flash.\+h$>$}\newline
{\ttfamily \#include $<$storage/flash\+\_\+map.\+h$>$}\newline
{\ttfamily \#include $<$dfu/mcuboot.\+h$>$}\newline
{\ttfamily \#include "{}../detools/detools.\+h"{}}\newline
\doxysubsubsection*{Data Structures}
\begin{DoxyCompactItemize}
\item 
struct \mbox{\hyperlink{structflash__mem}{flash\+\_\+mem}}
\end{DoxyCompactItemize}
\doxysubsubsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \mbox{\hyperlink{delta_8h_aaf3d2873ba802a4ca736629d8d410687}{PRIMARY\+\_\+\+OFFSET}}~FLASH\+\_\+\+AREA\+\_\+\+OFFSET(image\+\_\+0)
\item 
\#define \mbox{\hyperlink{delta_8h_ad8421125c8f30502edede04e13d0e741}{PRIMARY\+\_\+\+SIZE}}~FLASH\+\_\+\+AREA\+\_\+\+SIZE(image\+\_\+0)
\item 
\#define \mbox{\hyperlink{delta_8h_ad724f9988e15166005f0345d1a6f70df}{SECONDARY\+\_\+\+OFFSET}}~FLASH\+\_\+\+AREA\+\_\+\+OFFSET(image\+\_\+1)
\item 
\#define \mbox{\hyperlink{delta_8h_a851719bd705287643dc44e9d4e8c204f}{SECONDARY\+\_\+\+SIZE}}~FLASH\+\_\+\+AREA\+\_\+\+SIZE(image\+\_\+1)
\item 
\#define \mbox{\hyperlink{delta_8h_a41c1f704127f9bd266da0b0e39d3270f}{STORAGE\+\_\+\+OFFSET}}~FLASH\+\_\+\+AREA\+\_\+\+OFFSET(storage)
\item 
\#define \mbox{\hyperlink{delta_8h_a8d6f782ffe53d87f0fd0327d4b09352c}{STORAGE\+\_\+\+SIZE}}~FLASH\+\_\+\+AREA\+\_\+\+SIZE(storage)
\item 
\#define \mbox{\hyperlink{delta_8h_aefb7d0886bfc3273f188c4a116d10e3b}{THIRD\+\_\+\+OFFSET}}~FLASH\+\_\+\+AREA\+\_\+\+OFFSET(image\+\_\+2)
\item 
\#define \mbox{\hyperlink{delta_8h_a3d4a4c871ff87601c1052bfb4e2e367d}{THIRD\+\_\+\+SIZE}}~FLASH\+\_\+\+AREA\+\_\+\+SIZE(image\+\_\+2)
\item 
\#define \mbox{\hyperlink{delta_8h_a49999be01380f41cc0d0f1f1406fb277}{HEADER\+\_\+\+SIZE}}~0x8
\item 
\#define \mbox{\hyperlink{delta_8h_a7d467c1d283fdfa1f2081ba1e0d01b6e}{PAGE\+\_\+\+SIZE}}~0x2048
\item 
\#define \mbox{\hyperlink{delta_8h_af63b4b57be1752fb8836d92f594ec615}{DELTA\+\_\+\+OK}}~0
\item 
\#define \mbox{\hyperlink{delta_8h_a84faa70a37e6409dcfe4d20bf2c2ac25}{DELTA\+\_\+\+SLOT1\+\_\+\+OUT\+\_\+\+OF\+\_\+\+MEMORY}}~28
\item 
\#define \mbox{\hyperlink{delta_8h_a60a765e1c5f7bbe796923b235db1d645}{DELTA\+\_\+\+READING\+\_\+\+PATCH\+\_\+\+ERROR}}~29
\item 
\#define \mbox{\hyperlink{delta_8h_a920a72de3a625c4f7b122af413cee62b}{DELTA\+\_\+\+READING\+\_\+\+SOURCE\+\_\+\+ERROR}}~30
\item 
\#define \mbox{\hyperlink{delta_8h_a8a58e1b7d48fbd037e363760954a37b7}{DELTA\+\_\+\+WRITING\+\_\+\+ERROR}}~31
\item 
\#define \mbox{\hyperlink{delta_8h_aeaf0fc677848e884434a83657c4f25b2}{DELTA\+\_\+\+SEEKING\+\_\+\+ERROR}}~32
\item 
\#define \mbox{\hyperlink{delta_8h_a5265eb1db2aee9d9a5183241a0e95924}{DELTA\+\_\+\+CASTING\+\_\+\+ERROR}}~33
\item 
\#define \mbox{\hyperlink{delta_8h_aa39c54d1d1f55c90583beefd31a9e693}{DELTA\+\_\+\+INVALID\+\_\+\+BUF\+\_\+\+SIZE}}~34
\item 
\#define \mbox{\hyperlink{delta_8h_a460256a054ef45ba7e61483fd26070b4}{DELTA\+\_\+\+CLEARING\+\_\+\+ERROR}}~35
\item 
\#define \mbox{\hyperlink{delta_8h_add8f61330a68e76515787b0eacdb85f6}{DELTA\+\_\+\+NO\+\_\+\+FLASH\+\_\+\+FOUND}}~36
\item 
\#define \mbox{\hyperlink{delta_8h_ab0b2d46406cb46eba0e5ebfc80f837d1}{DELTA\+\_\+\+PATCH\+\_\+\+HEADER\+\_\+\+ERROR}}~37
\end{DoxyCompactItemize}
\doxysubsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
int \mbox{\hyperlink{delta_8h_ac8e66efa303d4fae63607bb75081891c}{delta\+\_\+check\+\_\+and\+\_\+apply}} (struct \mbox{\hyperlink{structflash__mem}{flash\+\_\+mem}} \texorpdfstring{$\ast$}{*}flash)
\item 
int \mbox{\hyperlink{delta_8h_ae4774f6d0b67063071c40af79ed6fe55}{delta\+\_\+read\+\_\+patch\+\_\+header}} (struct \mbox{\hyperlink{structflash__mem}{flash\+\_\+mem}} \texorpdfstring{$\ast$}{*}flash, uint32\+\_\+t \texorpdfstring{$\ast$}{*}size)
\item 
const char \texorpdfstring{$\ast$}{*} \mbox{\hyperlink{delta_8h_a16a81712ea142d7efad9356b4c47573f}{delta\+\_\+error\+\_\+as\+\_\+string}} (int error)
\end{DoxyCompactItemize}


\doxysubsection{Macro Definition Documentation}
\Hypertarget{delta_8h_a5265eb1db2aee9d9a5183241a0e95924}\label{delta_8h_a5265eb1db2aee9d9a5183241a0e95924} 
\index{delta.h@{delta.h}!DELTA\_CASTING\_ERROR@{DELTA\_CASTING\_ERROR}}
\index{DELTA\_CASTING\_ERROR@{DELTA\_CASTING\_ERROR}!delta.h@{delta.h}}
\doxysubsubsection{\texorpdfstring{DELTA\_CASTING\_ERROR}{DELTA\_CASTING\_ERROR}}
{\footnotesize\ttfamily \#define DELTA\+\_\+\+CASTING\+\_\+\+ERROR~33}



Definition at line \mbox{\hyperlink{delta_8h_source_l00044}{44}} of file \mbox{\hyperlink{delta_8h_source}{delta.\+h}}.

\Hypertarget{delta_8h_a460256a054ef45ba7e61483fd26070b4}\label{delta_8h_a460256a054ef45ba7e61483fd26070b4} 
\index{delta.h@{delta.h}!DELTA\_CLEARING\_ERROR@{DELTA\_CLEARING\_ERROR}}
\index{DELTA\_CLEARING\_ERROR@{DELTA\_CLEARING\_ERROR}!delta.h@{delta.h}}
\doxysubsubsection{\texorpdfstring{DELTA\_CLEARING\_ERROR}{DELTA\_CLEARING\_ERROR}}
{\footnotesize\ttfamily \#define DELTA\+\_\+\+CLEARING\+\_\+\+ERROR~35}



Definition at line \mbox{\hyperlink{delta_8h_source_l00046}{46}} of file \mbox{\hyperlink{delta_8h_source}{delta.\+h}}.

\Hypertarget{delta_8h_aa39c54d1d1f55c90583beefd31a9e693}\label{delta_8h_aa39c54d1d1f55c90583beefd31a9e693} 
\index{delta.h@{delta.h}!DELTA\_INVALID\_BUF\_SIZE@{DELTA\_INVALID\_BUF\_SIZE}}
\index{DELTA\_INVALID\_BUF\_SIZE@{DELTA\_INVALID\_BUF\_SIZE}!delta.h@{delta.h}}
\doxysubsubsection{\texorpdfstring{DELTA\_INVALID\_BUF\_SIZE}{DELTA\_INVALID\_BUF\_SIZE}}
{\footnotesize\ttfamily \#define DELTA\+\_\+\+INVALID\+\_\+\+BUF\+\_\+\+SIZE~34}



Definition at line \mbox{\hyperlink{delta_8h_source_l00045}{45}} of file \mbox{\hyperlink{delta_8h_source}{delta.\+h}}.

\Hypertarget{delta_8h_add8f61330a68e76515787b0eacdb85f6}\label{delta_8h_add8f61330a68e76515787b0eacdb85f6} 
\index{delta.h@{delta.h}!DELTA\_NO\_FLASH\_FOUND@{DELTA\_NO\_FLASH\_FOUND}}
\index{DELTA\_NO\_FLASH\_FOUND@{DELTA\_NO\_FLASH\_FOUND}!delta.h@{delta.h}}
\doxysubsubsection{\texorpdfstring{DELTA\_NO\_FLASH\_FOUND}{DELTA\_NO\_FLASH\_FOUND}}
{\footnotesize\ttfamily \#define DELTA\+\_\+\+NO\+\_\+\+FLASH\+\_\+\+FOUND~36}



Definition at line \mbox{\hyperlink{delta_8h_source_l00047}{47}} of file \mbox{\hyperlink{delta_8h_source}{delta.\+h}}.

\Hypertarget{delta_8h_af63b4b57be1752fb8836d92f594ec615}\label{delta_8h_af63b4b57be1752fb8836d92f594ec615} 
\index{delta.h@{delta.h}!DELTA\_OK@{DELTA\_OK}}
\index{DELTA\_OK@{DELTA\_OK}!delta.h@{delta.h}}
\doxysubsubsection{\texorpdfstring{DELTA\_OK}{DELTA\_OK}}
{\footnotesize\ttfamily \#define DELTA\+\_\+\+OK~0}



Definition at line \mbox{\hyperlink{delta_8h_source_l00038}{38}} of file \mbox{\hyperlink{delta_8h_source}{delta.\+h}}.

\Hypertarget{delta_8h_ab0b2d46406cb46eba0e5ebfc80f837d1}\label{delta_8h_ab0b2d46406cb46eba0e5ebfc80f837d1} 
\index{delta.h@{delta.h}!DELTA\_PATCH\_HEADER\_ERROR@{DELTA\_PATCH\_HEADER\_ERROR}}
\index{DELTA\_PATCH\_HEADER\_ERROR@{DELTA\_PATCH\_HEADER\_ERROR}!delta.h@{delta.h}}
\doxysubsubsection{\texorpdfstring{DELTA\_PATCH\_HEADER\_ERROR}{DELTA\_PATCH\_HEADER\_ERROR}}
{\footnotesize\ttfamily \#define DELTA\+\_\+\+PATCH\+\_\+\+HEADER\+\_\+\+ERROR~37}



Definition at line \mbox{\hyperlink{delta_8h_source_l00048}{48}} of file \mbox{\hyperlink{delta_8h_source}{delta.\+h}}.

\Hypertarget{delta_8h_a60a765e1c5f7bbe796923b235db1d645}\label{delta_8h_a60a765e1c5f7bbe796923b235db1d645} 
\index{delta.h@{delta.h}!DELTA\_READING\_PATCH\_ERROR@{DELTA\_READING\_PATCH\_ERROR}}
\index{DELTA\_READING\_PATCH\_ERROR@{DELTA\_READING\_PATCH\_ERROR}!delta.h@{delta.h}}
\doxysubsubsection{\texorpdfstring{DELTA\_READING\_PATCH\_ERROR}{DELTA\_READING\_PATCH\_ERROR}}
{\footnotesize\ttfamily \#define DELTA\+\_\+\+READING\+\_\+\+PATCH\+\_\+\+ERROR~29}



Definition at line \mbox{\hyperlink{delta_8h_source_l00040}{40}} of file \mbox{\hyperlink{delta_8h_source}{delta.\+h}}.

\Hypertarget{delta_8h_a920a72de3a625c4f7b122af413cee62b}\label{delta_8h_a920a72de3a625c4f7b122af413cee62b} 
\index{delta.h@{delta.h}!DELTA\_READING\_SOURCE\_ERROR@{DELTA\_READING\_SOURCE\_ERROR}}
\index{DELTA\_READING\_SOURCE\_ERROR@{DELTA\_READING\_SOURCE\_ERROR}!delta.h@{delta.h}}
\doxysubsubsection{\texorpdfstring{DELTA\_READING\_SOURCE\_ERROR}{DELTA\_READING\_SOURCE\_ERROR}}
{\footnotesize\ttfamily \#define DELTA\+\_\+\+READING\+\_\+\+SOURCE\+\_\+\+ERROR~30}



Definition at line \mbox{\hyperlink{delta_8h_source_l00041}{41}} of file \mbox{\hyperlink{delta_8h_source}{delta.\+h}}.

\Hypertarget{delta_8h_aeaf0fc677848e884434a83657c4f25b2}\label{delta_8h_aeaf0fc677848e884434a83657c4f25b2} 
\index{delta.h@{delta.h}!DELTA\_SEEKING\_ERROR@{DELTA\_SEEKING\_ERROR}}
\index{DELTA\_SEEKING\_ERROR@{DELTA\_SEEKING\_ERROR}!delta.h@{delta.h}}
\doxysubsubsection{\texorpdfstring{DELTA\_SEEKING\_ERROR}{DELTA\_SEEKING\_ERROR}}
{\footnotesize\ttfamily \#define DELTA\+\_\+\+SEEKING\+\_\+\+ERROR~32}



Definition at line \mbox{\hyperlink{delta_8h_source_l00043}{43}} of file \mbox{\hyperlink{delta_8h_source}{delta.\+h}}.

\Hypertarget{delta_8h_a84faa70a37e6409dcfe4d20bf2c2ac25}\label{delta_8h_a84faa70a37e6409dcfe4d20bf2c2ac25} 
\index{delta.h@{delta.h}!DELTA\_SLOT1\_OUT\_OF\_MEMORY@{DELTA\_SLOT1\_OUT\_OF\_MEMORY}}
\index{DELTA\_SLOT1\_OUT\_OF\_MEMORY@{DELTA\_SLOT1\_OUT\_OF\_MEMORY}!delta.h@{delta.h}}
\doxysubsubsection{\texorpdfstring{DELTA\_SLOT1\_OUT\_OF\_MEMORY}{DELTA\_SLOT1\_OUT\_OF\_MEMORY}}
{\footnotesize\ttfamily \#define DELTA\+\_\+\+SLOT1\+\_\+\+OUT\+\_\+\+OF\+\_\+\+MEMORY~28}



Definition at line \mbox{\hyperlink{delta_8h_source_l00039}{39}} of file \mbox{\hyperlink{delta_8h_source}{delta.\+h}}.

\Hypertarget{delta_8h_a8a58e1b7d48fbd037e363760954a37b7}\label{delta_8h_a8a58e1b7d48fbd037e363760954a37b7} 
\index{delta.h@{delta.h}!DELTA\_WRITING\_ERROR@{DELTA\_WRITING\_ERROR}}
\index{DELTA\_WRITING\_ERROR@{DELTA\_WRITING\_ERROR}!delta.h@{delta.h}}
\doxysubsubsection{\texorpdfstring{DELTA\_WRITING\_ERROR}{DELTA\_WRITING\_ERROR}}
{\footnotesize\ttfamily \#define DELTA\+\_\+\+WRITING\+\_\+\+ERROR~31}



Definition at line \mbox{\hyperlink{delta_8h_source_l00042}{42}} of file \mbox{\hyperlink{delta_8h_source}{delta.\+h}}.

\Hypertarget{delta_8h_a49999be01380f41cc0d0f1f1406fb277}\label{delta_8h_a49999be01380f41cc0d0f1f1406fb277} 
\index{delta.h@{delta.h}!HEADER\_SIZE@{HEADER\_SIZE}}
\index{HEADER\_SIZE@{HEADER\_SIZE}!delta.h@{delta.h}}
\doxysubsubsection{\texorpdfstring{HEADER\_SIZE}{HEADER\_SIZE}}
{\footnotesize\ttfamily \#define HEADER\+\_\+\+SIZE~0x8}



Definition at line \mbox{\hyperlink{delta_8h_source_l00032}{32}} of file \mbox{\hyperlink{delta_8h_source}{delta.\+h}}.

\Hypertarget{delta_8h_a7d467c1d283fdfa1f2081ba1e0d01b6e}\label{delta_8h_a7d467c1d283fdfa1f2081ba1e0d01b6e} 
\index{delta.h@{delta.h}!PAGE\_SIZE@{PAGE\_SIZE}}
\index{PAGE\_SIZE@{PAGE\_SIZE}!delta.h@{delta.h}}
\doxysubsubsection{\texorpdfstring{PAGE\_SIZE}{PAGE\_SIZE}}
{\footnotesize\ttfamily \#define PAGE\+\_\+\+SIZE~0x2048}



Definition at line \mbox{\hyperlink{delta_8h_source_l00035}{35}} of file \mbox{\hyperlink{delta_8h_source}{delta.\+h}}.

\Hypertarget{delta_8h_aaf3d2873ba802a4ca736629d8d410687}\label{delta_8h_aaf3d2873ba802a4ca736629d8d410687} 
\index{delta.h@{delta.h}!PRIMARY\_OFFSET@{PRIMARY\_OFFSET}}
\index{PRIMARY\_OFFSET@{PRIMARY\_OFFSET}!delta.h@{delta.h}}
\doxysubsubsection{\texorpdfstring{PRIMARY\_OFFSET}{PRIMARY\_OFFSET}}
{\footnotesize\ttfamily \#define PRIMARY\+\_\+\+OFFSET~FLASH\+\_\+\+AREA\+\_\+\+OFFSET(image\+\_\+0)}



Definition at line \mbox{\hyperlink{delta_8h_source_l00021}{21}} of file \mbox{\hyperlink{delta_8h_source}{delta.\+h}}.

\Hypertarget{delta_8h_ad8421125c8f30502edede04e13d0e741}\label{delta_8h_ad8421125c8f30502edede04e13d0e741} 
\index{delta.h@{delta.h}!PRIMARY\_SIZE@{PRIMARY\_SIZE}}
\index{PRIMARY\_SIZE@{PRIMARY\_SIZE}!delta.h@{delta.h}}
\doxysubsubsection{\texorpdfstring{PRIMARY\_SIZE}{PRIMARY\_SIZE}}
{\footnotesize\ttfamily \#define PRIMARY\+\_\+\+SIZE~FLASH\+\_\+\+AREA\+\_\+\+SIZE(image\+\_\+0)}



Definition at line \mbox{\hyperlink{delta_8h_source_l00022}{22}} of file \mbox{\hyperlink{delta_8h_source}{delta.\+h}}.

\Hypertarget{delta_8h_ad724f9988e15166005f0345d1a6f70df}\label{delta_8h_ad724f9988e15166005f0345d1a6f70df} 
\index{delta.h@{delta.h}!SECONDARY\_OFFSET@{SECONDARY\_OFFSET}}
\index{SECONDARY\_OFFSET@{SECONDARY\_OFFSET}!delta.h@{delta.h}}
\doxysubsubsection{\texorpdfstring{SECONDARY\_OFFSET}{SECONDARY\_OFFSET}}
{\footnotesize\ttfamily \#define SECONDARY\+\_\+\+OFFSET~FLASH\+\_\+\+AREA\+\_\+\+OFFSET(image\+\_\+1)}



Definition at line \mbox{\hyperlink{delta_8h_source_l00023}{23}} of file \mbox{\hyperlink{delta_8h_source}{delta.\+h}}.

\Hypertarget{delta_8h_a851719bd705287643dc44e9d4e8c204f}\label{delta_8h_a851719bd705287643dc44e9d4e8c204f} 
\index{delta.h@{delta.h}!SECONDARY\_SIZE@{SECONDARY\_SIZE}}
\index{SECONDARY\_SIZE@{SECONDARY\_SIZE}!delta.h@{delta.h}}
\doxysubsubsection{\texorpdfstring{SECONDARY\_SIZE}{SECONDARY\_SIZE}}
{\footnotesize\ttfamily \#define SECONDARY\+\_\+\+SIZE~FLASH\+\_\+\+AREA\+\_\+\+SIZE(image\+\_\+1)}



Definition at line \mbox{\hyperlink{delta_8h_source_l00024}{24}} of file \mbox{\hyperlink{delta_8h_source}{delta.\+h}}.

\Hypertarget{delta_8h_a41c1f704127f9bd266da0b0e39d3270f}\label{delta_8h_a41c1f704127f9bd266da0b0e39d3270f} 
\index{delta.h@{delta.h}!STORAGE\_OFFSET@{STORAGE\_OFFSET}}
\index{STORAGE\_OFFSET@{STORAGE\_OFFSET}!delta.h@{delta.h}}
\doxysubsubsection{\texorpdfstring{STORAGE\_OFFSET}{STORAGE\_OFFSET}}
{\footnotesize\ttfamily \#define STORAGE\+\_\+\+OFFSET~FLASH\+\_\+\+AREA\+\_\+\+OFFSET(storage)}



Definition at line \mbox{\hyperlink{delta_8h_source_l00025}{25}} of file \mbox{\hyperlink{delta_8h_source}{delta.\+h}}.

\Hypertarget{delta_8h_a8d6f782ffe53d87f0fd0327d4b09352c}\label{delta_8h_a8d6f782ffe53d87f0fd0327d4b09352c} 
\index{delta.h@{delta.h}!STORAGE\_SIZE@{STORAGE\_SIZE}}
\index{STORAGE\_SIZE@{STORAGE\_SIZE}!delta.h@{delta.h}}
\doxysubsubsection{\texorpdfstring{STORAGE\_SIZE}{STORAGE\_SIZE}}
{\footnotesize\ttfamily \#define STORAGE\+\_\+\+SIZE~FLASH\+\_\+\+AREA\+\_\+\+SIZE(storage)}



Definition at line \mbox{\hyperlink{delta_8h_source_l00026}{26}} of file \mbox{\hyperlink{delta_8h_source}{delta.\+h}}.

\Hypertarget{delta_8h_aefb7d0886bfc3273f188c4a116d10e3b}\label{delta_8h_aefb7d0886bfc3273f188c4a116d10e3b} 
\index{delta.h@{delta.h}!THIRD\_OFFSET@{THIRD\_OFFSET}}
\index{THIRD\_OFFSET@{THIRD\_OFFSET}!delta.h@{delta.h}}
\doxysubsubsection{\texorpdfstring{THIRD\_OFFSET}{THIRD\_OFFSET}}
{\footnotesize\ttfamily \#define THIRD\+\_\+\+OFFSET~FLASH\+\_\+\+AREA\+\_\+\+OFFSET(image\+\_\+2)}



Definition at line \mbox{\hyperlink{delta_8h_source_l00027}{27}} of file \mbox{\hyperlink{delta_8h_source}{delta.\+h}}.

\Hypertarget{delta_8h_a3d4a4c871ff87601c1052bfb4e2e367d}\label{delta_8h_a3d4a4c871ff87601c1052bfb4e2e367d} 
\index{delta.h@{delta.h}!THIRD\_SIZE@{THIRD\_SIZE}}
\index{THIRD\_SIZE@{THIRD\_SIZE}!delta.h@{delta.h}}
\doxysubsubsection{\texorpdfstring{THIRD\_SIZE}{THIRD\_SIZE}}
{\footnotesize\ttfamily \#define THIRD\+\_\+\+SIZE~FLASH\+\_\+\+AREA\+\_\+\+SIZE(image\+\_\+2)}



Definition at line \mbox{\hyperlink{delta_8h_source_l00028}{28}} of file \mbox{\hyperlink{delta_8h_source}{delta.\+h}}.



\doxysubsection{Function Documentation}
\Hypertarget{delta_8h_ac8e66efa303d4fae63607bb75081891c}\label{delta_8h_ac8e66efa303d4fae63607bb75081891c} 
\index{delta.h@{delta.h}!delta\_check\_and\_apply@{delta\_check\_and\_apply}}
\index{delta\_check\_and\_apply@{delta\_check\_and\_apply}!delta.h@{delta.h}}
\doxysubsubsection{\texorpdfstring{delta\_check\_and\_apply()}{delta\_check\_and\_apply()}}
{\footnotesize\ttfamily int delta\+\_\+check\+\_\+and\+\_\+apply (\begin{DoxyParamCaption}\item[{struct \mbox{\hyperlink{structflash__mem}{flash\+\_\+mem}} \texorpdfstring{$\ast$}{*}}]{flash }\end{DoxyParamCaption})}

Checks if there is patch in the patch partition and applies that patch if it exists. Then restarts the device and boots from the new image.


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em flash} & the devices flash memory.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
zero(0) if no patch or a negative error code. 
\end{DoxyReturn}


Definition at line \mbox{\hyperlink{delta_8c_source_l00407}{407}} of file \mbox{\hyperlink{delta_8c_source}{delta.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00408\ \{}
\DoxyCodeLine{00409\ }
\DoxyCodeLine{00410\ \ \ \ \ \textcolor{comment}{//\ flash\_erase(flash-\/>device,\ (SECONDARY\_OFFSET),\ 0x6c000);\ \ \ //pages}}
\DoxyCodeLine{00411\ \ \ \ \ \textcolor{comment}{//\ printk("{}Flash\ erase\ complete\ \(\backslash\)n\(\backslash\)n"{});}}
\DoxyCodeLine{00412\ \ \ \ \ \textcolor{comment}{//\ return\ 0;}}
\DoxyCodeLine{00413\ }
\DoxyCodeLine{00414\ }
\DoxyCodeLine{00415\ \ \ \ \ uint32\_t\ patch\_size;\ }
\DoxyCodeLine{00416\ \ \ \ \ \textcolor{keywordtype}{int}\ ret;}
\DoxyCodeLine{00417\ }
\DoxyCodeLine{00418\ \ \ \ \ printk(\textcolor{stringliteral}{"{}-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/delta\_check\_and\_apply-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/\(\backslash\)n\(\backslash\)n"{}});}
\DoxyCodeLine{00419\ }
\DoxyCodeLine{00420\ \ \ \ \ ret\ =\ \mbox{\hyperlink{delta_8c_ae4774f6d0b67063071c40af79ed6fe55}{delta\_read\_patch\_header}}(flash,\&patch\_size);}
\DoxyCodeLine{00421\ }
\DoxyCodeLine{00422\ \ \ \ \ printk(\textcolor{stringliteral}{"{}Patch\_size:\ 0x\%08x\ \(\backslash\)n\(\backslash\)n"{}},\ patch\_size);}
\DoxyCodeLine{00423\ }
\DoxyCodeLine{00424\ \ \ \ \ \textcolor{keywordflow}{if}\ (ret\ <\ 0)\ \{}
\DoxyCodeLine{00425\ \ \ \ \ \ \ \ \ printk(\textcolor{stringliteral}{"{}Ret\ <\ 0:\ \%d\ \(\backslash\)n\(\backslash\)n"{}},\ ret);}
\DoxyCodeLine{00426\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ ret;}
\DoxyCodeLine{00427\ }
\DoxyCodeLine{00428\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (patch\_size\ >\ 0)\ \{}
\DoxyCodeLine{00429\ \ \ \ \ \ \ \ \ ret\ =\ delta\_init(flash);}
\DoxyCodeLine{00430\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00431\ \ \ \ \ \ \ \ \ printk(\textcolor{stringliteral}{"{}\(\backslash\)n-\/-\/delta\_check\_and\_apply\ -\/-\/>\ delta.c-\/-\/\(\backslash\)n"{}});}
\DoxyCodeLine{00432\ \ \ \ \ \ \ \ \ printk(\textcolor{stringliteral}{"{}\(\backslash\)n-\/-\/Output\_1-\/-\/\(\backslash\)n"{}});}
\DoxyCodeLine{00433\ \ \ \ \ \ \ \ \ printk(\textcolor{stringliteral}{"{}Patch\_size\ >\ 0\ -\/-\/>\ ret\ =\ \%d\ \(\backslash\)n\(\backslash\)n"{}},\ ret);}
\DoxyCodeLine{00434\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (ret)\ \{}
\DoxyCodeLine{00435\ \ \ \ \ \ \ \ \ \ \ \ \ printk(\textcolor{stringliteral}{"{}-\/-\/Output\_2-\/-\/\(\backslash\)n"{}});}
\DoxyCodeLine{00436\ \ \ \ \ \ \ \ \ \ \ \ \ printk(\textcolor{stringliteral}{"{}Patch\_size\ >\ 0\ -\/-\/>\ ret\ =\ \%d\ \(\backslash\)n\(\backslash\)n"{}},\ ret);}
\DoxyCodeLine{00437\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ ret;}
\DoxyCodeLine{00438\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00439\ \ \ \ \ \ \ \ \ ret\ =\ \mbox{\hyperlink{detools_8c_a3cafd9bf54d88dee4a2715d4ec3871a2}{detools\_apply\_patch\_callbacks}}(delta\_flash\_from\_read,}
\DoxyCodeLine{00440\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ delta\_flash\_seek,}
\DoxyCodeLine{00441\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ delta\_flash\_patch\_read,}
\DoxyCodeLine{00442\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (\textcolor{keywordtype}{size\_t})\ patch\_size,}
\DoxyCodeLine{00443\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ delta\_flash\_write,}
\DoxyCodeLine{00444\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ flash);}
\DoxyCodeLine{00445\ }
\DoxyCodeLine{00446\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (ret\ <=\ 0)\ \{}
\DoxyCodeLine{00447\ \ \ \ \ \ \ \ \ \ \ \ \ printk(\textcolor{stringliteral}{"{}\(\backslash\)n-\/-\/-\/Entering:\ delta\_check\_and\_apply\ -\/-\/-\/>\ in\ delta.c-\/-\/-\/-\/\(\backslash\)n\(\backslash\)n"{}});}
\DoxyCodeLine{00448\ \ \ \ \ \ \ \ \ \ \ \ \ printk(\textcolor{stringliteral}{"{}\(\backslash\)n-\/-\/Output\_3-\/-\/\(\backslash\)n\(\backslash\)n"{}});}
\DoxyCodeLine{00449\ \ \ \ \ \ \ \ \ \ \ \ \ printk(\textcolor{stringliteral}{"{}Ret\ =\ \%d\ \(\backslash\)n\(\backslash\)n"{}},\ ret);}
\DoxyCodeLine{00450\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ ret;}
\DoxyCodeLine{00451\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00452\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (boot\_request\_upgrade(BOOT\_UPGRADE\_PERMANENT))\ \{}
\DoxyCodeLine{00453\ \ \ \ \ \ \ \ \ \ \ \ \ printk(\textcolor{stringliteral}{"{}Boot\ Request\ \(\backslash\)n\(\backslash\)n"{}});}
\DoxyCodeLine{00454\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ -\/1;}
\DoxyCodeLine{00455\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00456\ \ \ \ \ \ \ \ \ \textcolor{comment}{//sys\_reboot(SYS\_REBOOT\_COLD);}}
\DoxyCodeLine{00457\ }
\DoxyCodeLine{00458\ \ \ \ \ \ \ \ \ printk(\textcolor{stringliteral}{"{}Ret\ =\ \%d\ \(\backslash\)n\(\backslash\)n"{}},\ ret);}
\DoxyCodeLine{00459\ }
\DoxyCodeLine{00460\ \ \ \ \ \}}
\DoxyCodeLine{00461\ }
\DoxyCodeLine{00462\ \ \ \ \ printk(\textcolor{stringliteral}{"{}Delta\ OK\ \%d\ \(\backslash\)n"{}},\ \mbox{\hyperlink{delta_8h_af63b4b57be1752fb8836d92f594ec615}{DELTA\_OK}});}
\DoxyCodeLine{00463\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{delta_8h_af63b4b57be1752fb8836d92f594ec615}{DELTA\_OK}};}
\DoxyCodeLine{00464\ \}}

\end{DoxyCode}
\Hypertarget{delta_8h_a16a81712ea142d7efad9356b4c47573f}\label{delta_8h_a16a81712ea142d7efad9356b4c47573f} 
\index{delta.h@{delta.h}!delta\_error\_as\_string@{delta\_error\_as\_string}}
\index{delta\_error\_as\_string@{delta\_error\_as\_string}!delta.h@{delta.h}}
\doxysubsubsection{\texorpdfstring{delta\_error\_as\_string()}{delta\_error\_as\_string()}}
{\footnotesize\ttfamily const char \texorpdfstring{$\ast$}{*} delta\+\_\+error\+\_\+as\+\_\+string (\begin{DoxyParamCaption}\item[{int}]{error }\end{DoxyParamCaption})}

Get the error string for given error code.


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em Error} & code.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Error string. 
\end{DoxyReturn}


Definition at line \mbox{\hyperlink{delta_8c_source_l00563}{563}} of file \mbox{\hyperlink{delta_8c_source}{delta.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00564\ \{}
\DoxyCodeLine{00565\ \ \ \ \ \textcolor{keywordflow}{if}\ (error\ <\ 28)\ \{\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{detools_8c_ab744d2b15ec7495834d002c89fd88e14}{detools\_error\_as\_string}}(error);\ \}}
\DoxyCodeLine{00566\ }
\DoxyCodeLine{00567\ \ \ \ \ \textcolor{keywordflow}{if}\ (error\ <\ 0)\ \{\ error\ *=\ -\/1;\ \}}
\DoxyCodeLine{00568\ }
\DoxyCodeLine{00569\ \ \ \ \ \textcolor{keywordflow}{switch}\ (error)\ \{}
\DoxyCodeLine{00570\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{delta_8h_a84faa70a37e6409dcfe4d20bf2c2ac25}{DELTA\_SLOT1\_OUT\_OF\_MEMORY}}:}
\DoxyCodeLine{00571\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}Slot\ 1\ out\ of\ memory."{}};}
\DoxyCodeLine{00572\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{delta_8h_a60a765e1c5f7bbe796923b235db1d645}{DELTA\_READING\_PATCH\_ERROR}}:}
\DoxyCodeLine{00573\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}Error\ reading\ patch."{}};}
\DoxyCodeLine{00574\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{delta_8h_a920a72de3a625c4f7b122af413cee62b}{DELTA\_READING\_SOURCE\_ERROR}}:}
\DoxyCodeLine{00575\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}Error\ reading\ source\ image."{}};}
\DoxyCodeLine{00576\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{delta_8h_a8a58e1b7d48fbd037e363760954a37b7}{DELTA\_WRITING\_ERROR}}:}
\DoxyCodeLine{00577\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}Error\ writing\ to\ slot\ 1."{}};}
\DoxyCodeLine{00578\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{delta_8h_aeaf0fc677848e884434a83657c4f25b2}{DELTA\_SEEKING\_ERROR}}:}
\DoxyCodeLine{00579\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}Seek\ error."{}};}
\DoxyCodeLine{00580\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{delta_8h_a5265eb1db2aee9d9a5183241a0e95924}{DELTA\_CASTING\_ERROR}}:}
\DoxyCodeLine{00581\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}Error\ casting\ to\ flash\_mem."{}};}
\DoxyCodeLine{00582\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{delta_8h_aa39c54d1d1f55c90583beefd31a9e693}{DELTA\_INVALID\_BUF\_SIZE}}:}
\DoxyCodeLine{00583\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}Read/write\ buffer\ less\ or\ equal\ to\ 0."{}};}
\DoxyCodeLine{00584\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{delta_8h_a460256a054ef45ba7e61483fd26070b4}{DELTA\_CLEARING\_ERROR}}:}
\DoxyCodeLine{00585\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}Could\ not\ clear\ slot\ 1."{}};}
\DoxyCodeLine{00586\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{delta_8h_add8f61330a68e76515787b0eacdb85f6}{DELTA\_NO\_FLASH\_FOUND}}:}
\DoxyCodeLine{00587\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}No\ flash\ found."{}};}
\DoxyCodeLine{00588\ \ \ \ \ \textcolor{keywordflow}{case}\ \mbox{\hyperlink{delta_8h_ab0b2d46406cb46eba0e5ebfc80f837d1}{DELTA\_PATCH\_HEADER\_ERROR}}:}
\DoxyCodeLine{00589\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}Error\ reading\ patch\ header."{}};}
\DoxyCodeLine{00590\ \ \ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{00591\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}Unknown\ error."{}};}
\DoxyCodeLine{00592\ \ \ \ \ \}}
\DoxyCodeLine{00593\ \}}

\end{DoxyCode}
\Hypertarget{delta_8h_ae4774f6d0b67063071c40af79ed6fe55}\label{delta_8h_ae4774f6d0b67063071c40af79ed6fe55} 
\index{delta.h@{delta.h}!delta\_read\_patch\_header@{delta\_read\_patch\_header}}
\index{delta\_read\_patch\_header@{delta\_read\_patch\_header}!delta.h@{delta.h}}
\doxysubsubsection{\texorpdfstring{delta\_read\_patch\_header()}{delta\_read\_patch\_header()}}
{\footnotesize\ttfamily int delta\+\_\+read\+\_\+patch\+\_\+header (\begin{DoxyParamCaption}\item[{struct \mbox{\hyperlink{structflash__mem}{flash\+\_\+mem}} \texorpdfstring{$\ast$}{*}}]{flash,  }\item[{uint32\+\_\+t \texorpdfstring{$\ast$}{*}}]{size }\end{DoxyParamCaption})}

Functiong for reading the metadata from the patch and changing the header to mark that the patch has been applied.


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em flash} & the devices flash memory.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
zero(0) if not patch, a negative value (0\texorpdfstring{$>$}{>}) representing an error, or a positive value (0\texorpdfstring{$<$}{<}) representing the patch size. 
\end{DoxyReturn}


Definition at line \mbox{\hyperlink{delta_8c_source_l00465}{465}} of file \mbox{\hyperlink{delta_8c_source}{delta.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00466\ \{}
\DoxyCodeLine{00467\ \ \ \ \ \textcolor{comment}{//int\ offset\ =\ 0x00000000;}}
\DoxyCodeLine{00468\ }
\DoxyCodeLine{00469\ \ \ \ \ uint32\_t\ new\_patch,\ reset\_msg[2]\ =\ \{0\},\ patch\_header[2]\ =\ \{0\},\ page\_buffer[2048];}
\DoxyCodeLine{00470\ }
\DoxyCodeLine{00471\ }
\DoxyCodeLine{00472\ }
\DoxyCodeLine{00473\ \ \ \ \ new\_patch\ =\ 0x5057454E;\ \textcolor{comment}{//\ ASCII\ for\ "{}NEWP"{}\ signaling\ new\ patch}}
\DoxyCodeLine{00474\ \ \ \ \ reset\_msg[0]\ =\ 0xFFFFFFFFU;\ \ \ \ \ \ \ \textcolor{comment}{//\ reset\ "{}NEWP"{}}}
\DoxyCodeLine{00475\ }
\DoxyCodeLine{00476\ \ \ \ \ printk(\textcolor{stringliteral}{"{}\(\backslash\)n-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/1-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/\(\backslash\)r\(\backslash\)n"{}});}
\DoxyCodeLine{00477\ \ \ \ \ printk(\textcolor{stringliteral}{"{}'NEWP'\ Patch\ Message\ in\ HEX:\ 0x\%08x\ \(\backslash\)n\(\backslash\)n"{}},\ new\_patch);}
\DoxyCodeLine{00478\ \ \ \ \ printk(\textcolor{stringliteral}{"{}Reset\ Message\ [0]:\ 0x\%08x\ \(\backslash\)n"{}},\ reset\_msg[0]);}
\DoxyCodeLine{00479\ \ \ \ \ printk(\textcolor{stringliteral}{"{}Reset\ Message\ [1]:\ 0x\%08x\ \(\backslash\)n\(\backslash\)n"{}},\ reset\_msg[1]);}
\DoxyCodeLine{00480\ \ \ \ \ printk(\textcolor{stringliteral}{"{}Patch\ Header[0]\ ('NEWP'):\ 0x\%08x\ \(\backslash\)n"{}},\ patch\_header[0]);}
\DoxyCodeLine{00481\ \ \ \ \ printk(\textcolor{stringliteral}{"{}Patch\ Header[1]\ (Patch\ Size):\ 0x\%08x\ \(\backslash\)n"{}},\ patch\_header[1]);}
\DoxyCodeLine{00482\ }
\DoxyCodeLine{00483\ }
\DoxyCodeLine{00484\ \ \ \ \ }
\DoxyCodeLine{00485\ \ \ \ \ \textcolor{comment}{/*}}
\DoxyCodeLine{00486\ \textcolor{comment}{\ \ \ \ for(int\ i\ =\ 0;\ i\ <\ (0x100000);\ i++)}}
\DoxyCodeLine{00487\ \textcolor{comment}{\ \ \ \ \{}}
\DoxyCodeLine{00488\ \textcolor{comment}{\ \ \ \ \ \ \ \ if\ (flash\_read(flash-\/>device,\ offset,\ patch\_header,\ 4))\ \{\ return\ -\/DELTA\_PATCH\_HEADER\_ERROR;\ \}\ }}
\DoxyCodeLine{00489\ \textcolor{comment}{\ \ \ \ \ \ \ \ }}
\DoxyCodeLine{00490\ \textcolor{comment}{\ \ \ \ \ \ \ \ if(patch\_header[0]\ ==\ 0xefbeadba)}}
\DoxyCodeLine{00491\ \textcolor{comment}{\ \ \ \ \ \ \ \ \{}}
\DoxyCodeLine{00492\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ printk("{}Record\ found\ at\ offset\ 0x\%08x\(\backslash\)r\(\backslash\)n"{},\ offset);}}
\DoxyCodeLine{00493\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ //break;}}
\DoxyCodeLine{00494\ \textcolor{comment}{\ \ \ \ \ \ \ \ \}}}
\DoxyCodeLine{00495\ \textcolor{comment}{\ \ \ \ \ \ \ \ offset\ +=\ 4;}}
\DoxyCodeLine{00496\ \textcolor{comment}{}}
\DoxyCodeLine{00497\ \textcolor{comment}{\ \ \ \ \ \ \ \ //printk("{}Offset\ Count\ 0x\%08x\(\backslash\)r\(\backslash\)n"{},\ offset);}}
\DoxyCodeLine{00498\ \textcolor{comment}{}}
\DoxyCodeLine{00499\ \textcolor{comment}{\ \ \ \ \}}}
\DoxyCodeLine{00500\ \textcolor{comment}{\ \ \ \ */}}
\DoxyCodeLine{00501\ }
\DoxyCodeLine{00502\ \ \ \ \ \textcolor{keywordflow}{if}\ (flash\_read(flash-\/>\mbox{\hyperlink{structflash__mem_aa1f78abf61a59cbd09d602ab4485e7d1}{device}},\ (\mbox{\hyperlink{delta_8h_a41c1f704127f9bd266da0b0e39d3270f}{STORAGE\_OFFSET}}),\ patch\_header,\ \textcolor{keyword}{sizeof}(patch\_header)))\ \{\ \textcolor{keywordflow}{return}\ -\/\mbox{\hyperlink{delta_8h_ab0b2d46406cb46eba0e5ebfc80f837d1}{DELTA\_PATCH\_HEADER\_ERROR}};\ \}}
\DoxyCodeLine{00503\ \ \ \ \ }
\DoxyCodeLine{00504\ \ \ \ \ printk(\textcolor{stringliteral}{"{}\(\backslash\)nOffset\ Count\ 0x\%08x\(\backslash\)r\(\backslash\)n\(\backslash\)n"{}},\ \mbox{\hyperlink{delta_8h_a41c1f704127f9bd266da0b0e39d3270f}{STORAGE\_OFFSET}});}
\DoxyCodeLine{00505\ }
\DoxyCodeLine{00506\ \ \ \ \ printk(\textcolor{stringliteral}{"{}Patch\ Header[0]\ ('NEWP'):\ 0x\%08x\ \(\backslash\)n"{}},\ patch\_header[0]);}
\DoxyCodeLine{00507\ \ \ \ \ printk(\textcolor{stringliteral}{"{}Patch\ Header[1]\ ('Patch\ Size'):\ 0x\%08x\ \(\backslash\)n"{}},\ patch\_header[1]);}
\DoxyCodeLine{00508\ }
\DoxyCodeLine{00509\ \ \ \ \ printk(\textcolor{stringliteral}{"{}-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/\(\backslash\)r\(\backslash\)n"{}});}
\DoxyCodeLine{00510\ }
\DoxyCodeLine{00511\ \ \ \ \ \textcolor{keywordflow}{if}\ (new\_patch\ !=\ patch\_header[0])\ \{}
\DoxyCodeLine{00512\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{delta_8h_af63b4b57be1752fb8836d92f594ec615}{DELTA\_OK}};\ }
\DoxyCodeLine{00513\ \ \ \ \ \ \ \ \ printk(\textcolor{stringliteral}{"{}New\_patch\ !=\ patch\_header[0]\ ???"{}});}
\DoxyCodeLine{00514\ \ \ \ \ \ \ \ \ printk(\textcolor{stringliteral}{"{}-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/\(\backslash\)r\(\backslash\)n"{}});}
\DoxyCodeLine{00515\ }
\DoxyCodeLine{00516\ \ \ \ \ \}}
\DoxyCodeLine{00517\ }
\DoxyCodeLine{00518\ \ \ \ \ reset\_msg[1]\ =\ 0xFFFFFFFFU;\ \textcolor{comment}{//patch\_header[1];}}
\DoxyCodeLine{00519\ }
\DoxyCodeLine{00520\ \ \ \ \ printk(\textcolor{stringliteral}{"{}Reset\ Message\ [0]:\ 0x\%08x\ \(\backslash\)n"{}},\ reset\_msg[0]);}
\DoxyCodeLine{00521\ \ \ \ \ printk(\textcolor{stringliteral}{"{}Reset\ Message\ [1]:\ 0x\%08x\ \(\backslash\)n\(\backslash\)n"{}},\ reset\_msg[1]);}
\DoxyCodeLine{00522\ }
\DoxyCodeLine{00523\ }
\DoxyCodeLine{00524\ \ \ \ \ *size\ =\ patch\_header[1];}
\DoxyCodeLine{00525\ \ \ \ \ printk(\textcolor{stringliteral}{"{}size\ =\ patch\_header[1]:\ \%p\ \(\backslash\)n"{}},\ size);}
\DoxyCodeLine{00526\ }
\DoxyCodeLine{00527\ \ \ \ \ printk(\textcolor{stringliteral}{"{}-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/\(\backslash\)r\(\backslash\)n"{}});}
\DoxyCodeLine{00528\ }
\DoxyCodeLine{00529\ \ \ \ \ \textcolor{comment}{//custom\ buffer}}
\DoxyCodeLine{00530\ \ \ \ \ \textcolor{keywordflow}{if}\ (flash\_read(flash-\/>\mbox{\hyperlink{structflash__mem_aa1f78abf61a59cbd09d602ab4485e7d1}{device}},\ (\mbox{\hyperlink{delta_8h_a41c1f704127f9bd266da0b0e39d3270f}{STORAGE\_OFFSET}}),\ page\_buffer,\ 2048))\ \{\ \textcolor{keywordflow}{return}\ -\/\mbox{\hyperlink{delta_8h_ab0b2d46406cb46eba0e5ebfc80f837d1}{DELTA\_PATCH\_HEADER\_ERROR}};\ \}}
\DoxyCodeLine{00531\ \ \ \ \ \textcolor{comment}{//instead\ of\ reset\_msg}}
\DoxyCodeLine{00532\ \ \ \ \ page\_buffer[0]\ =\ 0;}
\DoxyCodeLine{00533\ }
\DoxyCodeLine{00534\ \ \ \ \ flash\_erase(flash-\/>\mbox{\hyperlink{structflash__mem_aa1f78abf61a59cbd09d602ab4485e7d1}{device}},\ (\mbox{\hyperlink{delta_8h_a41c1f704127f9bd266da0b0e39d3270f}{STORAGE\_OFFSET}}),\ 2048);}
\DoxyCodeLine{00535\ }
\DoxyCodeLine{00536\ \ \ \ \ flash\_erase(flash-\/>\mbox{\hyperlink{structflash__mem_aa1f78abf61a59cbd09d602ab4485e7d1}{device}},\ (\mbox{\hyperlink{delta_8h_ad724f9988e15166005f0345d1a6f70df}{SECONDARY\_OFFSET}}),\ 442368);\ \textcolor{comment}{//0x8c000);\ \ \ //pages=1728}}
\DoxyCodeLine{00537\ \ \ \ \ \textcolor{comment}{//return\ 0;}}
\DoxyCodeLine{00538\ }
\DoxyCodeLine{00539\ \ \ \ \ \textcolor{keywordflow}{if}\ (flash\_write\_protection\_set(flash-\/>\mbox{\hyperlink{structflash__mem_aa1f78abf61a59cbd09d602ab4485e7d1}{device}},\ \textcolor{keyword}{false}))\ }
\DoxyCodeLine{00540\ \ \ \ \ \{\ \ \ }
\DoxyCodeLine{00541\ \ \ \ \ \ \ \ \ \ printk(\textcolor{stringliteral}{"{}Write\ protection\ SET\(\backslash\)r\(\backslash\)n"{}});}
\DoxyCodeLine{00542\ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ -\/\mbox{\hyperlink{delta_8h_ab0b2d46406cb46eba0e5ebfc80f837d1}{DELTA\_PATCH\_HEADER\_ERROR}};\ }
\DoxyCodeLine{00543\ \ \ \ \ \}}
\DoxyCodeLine{00544\ }
\DoxyCodeLine{00545\ \ \ \ \ \textcolor{comment}{//if\ (flash\_write(flash-\/>device,\ STORAGE\_OFFSET,\ reset\_msg,\ sizeof(reset\_msg)))\ }}
\DoxyCodeLine{00546\ \ \ \ \ \textcolor{keywordflow}{if}\ (flash\_write(flash-\/>\mbox{\hyperlink{structflash__mem_aa1f78abf61a59cbd09d602ab4485e7d1}{device}},\ \mbox{\hyperlink{delta_8h_a41c1f704127f9bd266da0b0e39d3270f}{STORAGE\_OFFSET}},\ page\_buffer,\ 2048))\ }
\DoxyCodeLine{00547\ \ \ \ \ \{}
\DoxyCodeLine{00548\ \ \ \ \ \ \ \ \ \ printk(\textcolor{stringliteral}{"{}-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/\(\backslash\)r\(\backslash\)n\(\backslash\)n"{}});}
\DoxyCodeLine{00549\ \ \ \ \ \ \ \ \ \ printk(\textcolor{stringliteral}{"{}Flash\ Write\ SET\(\backslash\)r\(\backslash\)n\(\backslash\)n"{}});}
\DoxyCodeLine{00550\ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ -\/\mbox{\hyperlink{delta_8h_ab0b2d46406cb46eba0e5ebfc80f837d1}{DELTA\_PATCH\_HEADER\_ERROR}};\ }
\DoxyCodeLine{00551\ \ \ \ \ \}}
\DoxyCodeLine{00552\ }
\DoxyCodeLine{00553\ \ \ \ \ \textcolor{keywordflow}{if}\ (flash\_write\_protection\_set(flash-\/>\mbox{\hyperlink{structflash__mem_aa1f78abf61a59cbd09d602ab4485e7d1}{device}},\ \textcolor{keyword}{true}))\ }
\DoxyCodeLine{00554\ \ \ \ \ \{\ }
\DoxyCodeLine{00555\ \ \ \ \ \ \ \ \ printk(\textcolor{stringliteral}{"{}Write\ protection\ SET\(\backslash\)r\(\backslash\)n"{}});}
\DoxyCodeLine{00556\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ -\/\mbox{\hyperlink{delta_8h_ab0b2d46406cb46eba0e5ebfc80f837d1}{DELTA\_PATCH\_HEADER\_ERROR}};\ }
\DoxyCodeLine{00557\ \ \ \ \ \}}
\DoxyCodeLine{00558\ }
\DoxyCodeLine{00559\ \ \ \ \ }
\DoxyCodeLine{00560\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{delta_8h_af63b4b57be1752fb8836d92f594ec615}{DELTA\_OK}};}
\DoxyCodeLine{00561\ \}}

\end{DoxyCode}
